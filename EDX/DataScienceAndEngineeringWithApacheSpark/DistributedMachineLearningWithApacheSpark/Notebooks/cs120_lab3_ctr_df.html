<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>cs120_lab3_ctr_df - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"dbcForumURL":"http://forums.databricks.com/","nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","container_memory_mb":6000,"memory_mb":6144,"category":"Community Edition","num_cores":0.88}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":false,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enablePublishNotebooks":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Scala 2.11 experimental)","packageLabel":"spark-image-6b14149b5e0289081e7ddb7a7192b0e78d00c683e64d4ab1ad924536db4a6298","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Scala 2.10)","packageLabel":"spark-image-a6bd5da553a753c9b21a57cb934d5d3ae4da3b87a54e91e8b92d5e4ecddd3bfe","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"r3.8xlarge":8,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"development-node":1,"i2.2xlarge":3,"memory-optimized":1,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"c4.8xlarge":4,"r3.xlarge":1,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.24.3","accountsLimit":3,"enableNotebookGitBranching":true,"local":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"defaultSparkVersion":{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"showSqlEndpoints":false,"enableClusterAclsByTier":false,"disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"useFixedStaticNotebookVersionForDevelopment":false,"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAclService":true,"enableWorkspaceAcls":false,"gitHash":"","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"showDevTierBetaVersion":true,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/A%20Gentle%20Introduction%20to%20Apache%20Spark%20on%20Databricks.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/Quick%20Start%20DataFrames.html","displayName":"Quick Start DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/GSW%20Passing%20Analysis%20(new).html","displayName":"GSW Passing Analysis (new)","icon":"img/home/Python_icon.svg"}],"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableTerminal":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":1641625786991665,"name":"cs120_lab3_ctr_df","language":"python","commands":[{"version":"CommandV1","origId":1641625786991667,"guid":"ccca90a2-8ea5-4838-9603-375c441ec024","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n<a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc-nd/4.0/\"> <img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png\"/> </a> <br/> This work is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc-nd/4.0/\"> Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. </a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295349E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"af203904-a347-4069-9977-028d7bfdc5ca"},{"version":"CommandV1","origId":1641625786991668,"guid":"d1a732ea-c80e-49fe-9e6a-f52b61a3a374","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n![ML Logo](http://spark-mooc.github.io/web-assets/images/CS190.1x_Banner_300.png)\n# Click-Through Rate Prediction Lab\nThis lab covers the steps for creating a click-through rate (CTR) prediction pipeline.  You will work with the [Criteo Labs](http://labs.criteo.com/) dataset that was used for a recent [Kaggle competition](https://www.kaggle.com/c/criteo-display-ad-challenge).\n\n** This lab will cover: **\n\n* *Part 1:* Featurize categorical data using one-hot-encoding (OHE)\n\n* *Part 2:* Construct an OHE dictionary\n\n* *Part 3:* Parse CTR data and generate OHE features\n * *Visualization 1:* Feature frequency\n\n* *Part 4:* CTR prediction and logloss evaluation\n * *Visualization 2:* ROC curve\n\n* *Part 5:* Reduce feature dimension via feature hashing\n\n> Note that, for reference, you can look up the details of:\n> * the relevant Spark methods in [PySpark's DataFrame API](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.DataFrame)\n> * the relevant NumPy methods in the [NumPy Reference](http://docs.scipy.org/doc/numpy/reference/index.html)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295384E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d7ee0b74-73d2-42e3-839e-08381dc4d9b4"},{"version":"CommandV1","origId":1641625786991669,"guid":"804ef0d8-2076-4e5b-8308-e93cc31044f7","subtype":"command","commandType":"auto","position":3.0,"command":"labVersion = 'cs120x-criteo-1.0.0'","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.469747297853E12,"submitTime":1.469747295407E12,"finishTime":1.469747297893E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"41cc8df2-6111-4056-83a9-391be2dea233"},{"version":"CommandV1","origId":1641625786991670,"guid":"d1aa3f7b-29fc-4d1b-9424-8cb1d95fe399","subtype":"command","commandType":"auto","position":4.0,"command":"from databricks_test_helper import Test","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.469747297898E12,"submitTime":1.469747295426E12,"finishTime":1.469747297921E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"27e70cfd-38bc-4c7c-ac61-876669e3a956"},{"version":"CommandV1","origId":1641625786991671,"guid":"24fe6a2e-25f1-4009-b03e-00ce7646a4be","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n## Part 1: Featurize categorical data using one-hot-encoding","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295441E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7946895c-d170-465d-ad23-505fce9436c5"},{"version":"CommandV1","origId":1641625786991672,"guid":"53cfeee6-7c9f-42f9-8bb7-03cd74fbd09a","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n### (1a) One-hot-encoding\n\nWe would like to develop code to convert categorical features to numerical ones, and to build intuition, we will work with a sample unlabeled dataset with three data points, with each data point representing an animal. The first feature indicates the type of animal (bear, cat, mouse); the second feature describes the animal's color (black, tabby); and the third (optional) feature describes what the animal eats (mouse, salmon).\n\nIn a one-hot-encoding (OHE) scheme, we want to represent each tuple of `(featureID, category)` via its own binary feature.  We can do this in Python by creating a dictionary that maps each tuple to a distinct integer, where the integer corresponds to a binary feature. To start, manually enter the entries in the OHE dictionary associated with the sample dataset by mapping the tuples to consecutive integers starting from zero,  ordering the tuples first by featureID and next by category.\n\nLater in this lab, we'll use OHE dictionaries to transform data points into compact lists of features that can be used in machine learning algorithms.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295463E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"10ab545d-24d5-4207-9863-d4b1af1b6808"},{"version":"CommandV1","origId":1641625786991673,"guid":"8717cee7-7d13-4fc2-9b94-222400dfc7b8","subtype":"command","commandType":"auto","position":7.0,"command":"# By default, when a shuffle operation occurs with DataFrames, the post-shuffle partition\n# count is 200. This is controlled by Spark configuration value spark.sql.shuffle.partitions.\n# 200 is a little too high for this data set, so we set the post-shuffle partition count to\n# twice the number of available threads in Community Edition.\nsqlContext.setConf('spark.sql.shuffle.partitions', '6')  # Set default partitions for DataFrame operations","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.469747297925E12,"submitTime":1.469747295488E12,"finishTime":1.469747297942E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b35e167d-2c6d-4bba-bcc5-49447197cb11"},{"version":"CommandV1","origId":1641625786991674,"guid":"5bb9500d-1c63-41c1-a6a8-0957ca8dc869","subtype":"command","commandType":"auto","position":8.0,"command":"from collections import defaultdict\n# Data for manual OHE\n# Note: the first data point does not include any value for the optional third feature\nsample_one = [(0, 'mouse'), (1, 'black')]\nsample_two = [(0, 'cat'), (1, 'tabby'), (2, 'mouse')]\nsample_three =  [(0, 'bear'), (1, 'black'), (2, 'salmon')]\n\ndef sample_to_row(sample):\n    tmp_dict = defaultdict(lambda: None)\n    tmp_dict.update(sample)\n    print(tmp_dict)\n    x = [tmp_dict[i] for i in range(3)]\n    print(x)\n    return x\n\nsqlContext.createDataFrame(map(sample_to_row, [sample_one, sample_two, sample_three]),\n                           ['animal', 'color', 'food']).show()\nsample_data_df = sqlContext.createDataFrame([(sample_one,), (sample_two,), (sample_three,)], ['features'])\nsample_data_df.show(truncate=False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defaultdict(&lt;function &lt;lambda&gt; at 0x7f4e209d0668&gt;, {0: &apos;mouse&apos;, 1: &apos;black&apos;})\n[&apos;mouse&apos;, &apos;black&apos;, None]\ndefaultdict(&lt;function &lt;lambda&gt; at 0x7f4e209d0668&gt;, {0: &apos;cat&apos;, 1: &apos;tabby&apos;, 2: &apos;mouse&apos;})\n[&apos;cat&apos;, &apos;tabby&apos;, &apos;mouse&apos;]\ndefaultdict(&lt;function &lt;lambda&gt; at 0x7f4e209d0668&gt;, {0: &apos;bear&apos;, 1: &apos;black&apos;, 2: &apos;salmon&apos;})\n[&apos;bear&apos;, &apos;black&apos;, &apos;salmon&apos;]\n+------+-----+------+\n|animal|color|  food|\n+------+-----+------+\n| mouse|black|  null|\n|   cat|tabby| mouse|\n|  bear|black|salmon|\n+------+-----+------+\n\n+---------------------------------+\n|features                         |\n+---------------------------------+\n|[[0,mouse], [1,black]]           |\n|[[0,cat], [1,tabby], [2,mouse]]  |\n|[[0,bear], [1,black], [2,salmon]]|\n+---------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.469747297945E12,"submitTime":1.469747295502E12,"finishTime":1.46974729827E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6fee7a5b-3a51-44a4-a963-8fd7f4457793"},{"version":"CommandV1","origId":1641625786991675,"guid":"d6910482-f7f6-41dc-b655-9438c0d82ab7","subtype":"command","commandType":"auto","position":9.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nsample_ohe_dict_manual = {}\nsample_ohe_dict_manual[(0, 'bear')] = 0\nsample_ohe_dict_manual[(0, 'cat')] = 1\nsample_ohe_dict_manual[(0, 'mouse')] = 2\nsample_ohe_dict_manual[(1,'black')] = 3\nsample_ohe_dict_manual[(1,'tabby')] = 4\nsample_ohe_dict_manual[(2,'mouse')] = 5\nsample_ohe_dict_manual[(2,'salmon')] = 6","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: unsupported operand type(s) for |: &apos;tuple&apos; and &apos;tuple&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-24-e0703a385ee0&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> sample_ohe_dict_manual <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">{</span><span class=\"ansiyellow\">}</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>sample_ohe_dict_manual<span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;bear&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">|</span> <span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> sample_ohe_dict_manual<span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;cat&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> sample_ohe_dict_manual<span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;mouse&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: unsupported operand type(s) for |: &apos;tuple&apos; and &apos;tuple&apos;\n</div>","workflows":[],"startTime":1.469747298273E12,"submitTime":1.469747295517E12,"finishTime":1.469747298318E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"87d80608-ca40-4991-914b-be5fd3de519d"},{"version":"CommandV1","origId":1641625786991676,"guid":"838bc1e3-3685-426b-8596-803924283a17","subtype":"command","commandType":"auto","position":10.0,"command":"# TEST One-hot-encoding (1a)\nTest.assertEqualsHashed(sample_ohe_dict_manual[(0, 'bear')],\n                        'b6589fc6ab0dc82cf12099d1c2d40ab994e8410c',\n                        \"incorrect value for sample_ohe_dict_manual[(0,'bear')]\")\nTest.assertEqualsHashed(sample_ohe_dict_manual[(0, 'cat')],\n                        '356a192b7913b04c54574d18c28d46e6395428ab',\n                        \"incorrect value for sample_ohe_dict_manual[(0,'cat')]\")\nTest.assertEqualsHashed(sample_ohe_dict_manual[(0, 'mouse')],\n                        'da4b9237bacccdf19c0760cab7aec4a8359010b0',\n                        \"incorrect value for sample_ohe_dict_manual[(0,'mouse')]\")\nTest.assertEqualsHashed(sample_ohe_dict_manual[(1, 'black')],\n                        '77de68daecd823babbb58edb1c8e14d7106e83bb',\n                        \"incorrect value for sample_ohe_dict_manual[(1,'black')]\")\nTest.assertEqualsHashed(sample_ohe_dict_manual[(1, 'tabby')],\n                        '1b6453892473a467d07372d45eb05abc2031647a',\n                        \"incorrect value for sample_ohe_dict_manual[(1,'tabby')]\")\nTest.assertEqualsHashed(sample_ohe_dict_manual[(2, 'mouse')],\n                        'ac3478d69a3c81fa62e60f5c3696165a4e5e6ac4',\n                        \"incorrect value for sample_ohe_dict_manual[(2,'mouse')]\")\nTest.assertEqualsHashed(sample_ohe_dict_manual[(2, 'salmon')],\n                        'c1dfd96eea8cc2b62785275bca38ac261256e278',\n                        \"incorrect value for sample_ohe_dict_manual[(2,'salmon')]\")\nTest.assertEquals(len(sample_ohe_dict_manual.keys()), 7,\n                  'incorrect number of keys in sample_ohe_dict_manual')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.469747298325E12,"submitTime":1.469747295531E12,"finishTime":1.469747298399E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"acceed98-a04e-409b-bf39-e89fdb13a03e"},{"version":"CommandV1","origId":1641625786991677,"guid":"133140f7-37cb-4faa-8489-fd002af7ef24","subtype":"command","commandType":"auto","position":11.0,"command":"%md\n### (1b) Sparse vectors\n\nData points can typically be represented with a small number of non-zero OHE features relative to the total number of features that occur in the dataset.  By leveraging this sparsity and using sparse vector representations for OHE data, we can reduce storage and computational burdens.  Below are a few sample vectors represented as dense numpy arrays.  Use [SparseVector](https://spark.apache.org/docs/latest/api/python/pyspark.mllib.html#pyspark.mllib.linalg.SparseVector) to represent them in a sparse fashion, and verify that both the sparse and dense representations yield the same results when computing [dot products](http://en.wikipedia.org/wiki/Dot_product) (we will later use MLlib to train classifiers via gradient descent, and MLlib will need to compute dot products between SparseVectors and dense parameter vectors).\n\nUse `SparseVector(size, *args)` to create a new sparse vector where size is the length of the vector and args is either:\n1. A list of indices and a list of values corresponding to the indices. The indices list must be sorted in ascending order. For example, SparseVector(5, [1, 3, 4], [10, 30, 40]) will represent the vector [0, 10, 0, 30, 40]. The non-zero indices are 1, 3 and 4. On the other hand, SparseVector(3, [2, 1], [5, 5]) will give you an error because the indices list [2, 1] is not in ascending order. Note: you cannot simply sort the indices list, because otherwise the values will not correspond to the respective indices anymore.\n2. A list of (index, value) pair. In this case, the indices need not be sorted. For example, SparseVector(5, [(3, 1), (1, 2)]) will give you the vector [0, 2, 0, 1, 0].\n\nSparseVectors are much more efficient when working with sparse data because they do not store zero values (only store non-zero values and their indices). You'll need to create a sparse vector representation of each dense vector `a_dense` and `b_dense`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295544E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"004b3e6a-73ff-46d0-af73-156fb1975734"},{"version":"CommandV1","origId":1641625786991678,"guid":"7c3e0f85-01d2-48e5-8c31-9dc9503471f0","subtype":"command","commandType":"auto","position":12.0,"command":"import numpy as np\nfrom pyspark.mllib.linalg import SparseVector","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.469747298402E12,"submitTime":1.469747295566E12,"finishTime":1.469747298475E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"534b53c8-09d1-4d8d-acda-2ff3e0b72f4f"},{"version":"CommandV1","origId":1641625786991679,"guid":"82e426a8-fce6-4fa8-b8de-77b45c540195","subtype":"command","commandType":"auto","position":13.0,"command":"# TODO: Replace <FILL IN> with appropriate code\na_dense = np.array([0., 3., 0., 4.])\nnon_zero = [value for value in a_dense if value != 0]\nindices = [i for i, value in enumerate(a_dense) if value != 0]\nprint(non_zero)\nprint(indices)\na_sparse = SparseVector(4,indices,non_zero)\n\nb_dense = np.array([0., 0., 0., 1.])\nb_sparse = SparseVector(4,[(3,1)])\n\nw = np.array([0.4, 3.1, -1.4, -.5])\nprint a_dense.dot(w)\nprint a_sparse.dot(w)\nprint b_dense.dot(w)\nprint b_sparse.dot(w)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[3.0, 4.0]\n[1, 3]\n7.3\n7.3\n-0.5\n-0.5\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-7-cf6affed0f48&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>a_dense <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>array<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0.</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">3.</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">0.</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">4.</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> non_zero <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span>value <span class=\"ansigreen\">for</span> value <span class=\"ansigreen\">in</span> a_dense <span class=\"ansigreen\">if</span> value <span class=\"ansiyellow\">!=</span> <span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> indices <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span>i <span class=\"ansigreen\">for</span> i<span class=\"ansiyellow\">,</span> value <span class=\"ansigreen\">in</span> enumerate<span class=\"ansiyellow\">(</span>a_dense<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">if</span> value <span class=\"ansiyellow\">!=</span> <span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> <span class=\"ansired\">#print(non_zero)</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined\n</div>","workflows":[],"startTime":1.469747298477E12,"submitTime":1.46974729558E12,"finishTime":1.469747298555E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d7b74e5f-43b1-446d-92ea-8f982130b6f2"},{"version":"CommandV1","origId":1641625786991680,"guid":"c6828a12-6020-4d85-bcaa-c286edd09eaa","subtype":"command","commandType":"auto","position":14.0,"command":"# TEST Sparse Vectors (1b)\nTest.assertTrue(isinstance(a_sparse, SparseVector), 'a_sparse needs to be an instance of SparseVector')\nTest.assertTrue(isinstance(b_sparse, SparseVector), 'a_sparse needs to be an instance of SparseVector')\nTest.assertTrue(a_dense.dot(w) == a_sparse.dot(w),\n                'dot product of a_dense and w should equal dot product of a_sparse and w')\nTest.assertTrue(b_dense.dot(w) == b_sparse.dot(w),\n                'dot product of b_dense and w should equal dot product of b_sparse and w')\nTest.assertTrue(a_sparse.numNonzeros() == 2, 'a_sparse should not store zero values')\nTest.assertTrue(b_sparse.numNonzeros() == 1, 'b_sparse should not store zero values')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.469747298559E12,"submitTime":1.469747295594E12,"finishTime":1.469747298632E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4db0ae7b-19f1-443e-a79c-265e0f70d17f"},{"version":"CommandV1","origId":1641625786991681,"guid":"09c40035-4a11-49d2-9eb8-c2eccf641675","subtype":"command","commandType":"auto","position":15.0,"command":"%md\n### (1c) OHE features as sparse vectors\n\nNow let's see how we can represent the OHE features for points in our sample dataset.  Using the mapping defined by the OHE dictionary from Part (1a), manually define OHE features for the three sample data points using SparseVector format.  Any feature that occurs in a point should have the value 1.0.  For example, the `DenseVector` for a point with features 2 and 4 would be `[0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0]`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.46974729561E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d7361842-f084-4dc7-b8e9-1967e280f0f5"},{"version":"CommandV1","origId":1641625786991682,"guid":"f1c8fff3-5062-4b90-aae2-107e8d6592ef","subtype":"command","commandType":"auto","position":16.0,"command":"# Reminder of the sample features\nsample_one = [(0, 'mouse'), (1, 'black')]\nsample_two = [(0, 'cat'), (1, 'tabby'), (2, 'mouse')]\nsample_three =  [(0, 'bear'), (1, 'black'), (2, 'salmon')]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747298635E12,"submitTime":1.469747295637E12,"finishTime":1.469747298709E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c1899c57-c63a-4777-9efe-5cd5e64a2c7e"},{"version":"CommandV1","origId":1781929634056973,"guid":"ac2d0cbf-2e17-4383-af14-2ec16c0cca6f","subtype":"command","commandType":"auto","position":16.5,"command":"from pprint import pprint\npprint(sample_ohe_dict_manual)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">{(0, &apos;bear&apos;): 0,\n (0, &apos;cat&apos;): 1,\n (0, &apos;mouse&apos;): 2,\n (1, &apos;black&apos;): 3,\n (1, &apos;tabby&apos;): 4,\n (2, &apos;mouse&apos;): 5,\n (2, &apos;salmon&apos;): 6}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747298712E12,"submitTime":1.469747295651E12,"finishTime":1.469747298753E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"25751ed4-3883-4325-b00a-32cd9a578164"},{"version":"CommandV1","origId":1641625786991683,"guid":"ea302d3b-0aba-49b3-8d44-d64537355e91","subtype":"command","commandType":"auto","position":17.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nsample_one_ohe_feat_manual = SparseVector(7,[2,3],[1,1])\nsample_two_ohe_feat_manual = SparseVector(7,[1,4,5],[1,1,1])\nsample_three_ohe_feat_manual = SparseVector(7,[(0,1),(3,1),(6,1)])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747298756E12,"submitTime":1.469747295665E12,"finishTime":1.469747298796E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"97fda802-a7eb-4c6e-bb32-ecac5ce66c45"},{"version":"CommandV1","origId":1641625786991684,"guid":"6a8c0ab1-9843-4120-b032-8c9dde07f904","subtype":"command","commandType":"auto","position":18.0,"command":"# TEST OHE Features as sparse vectors (1c)\nTest.assertTrue(isinstance(sample_one_ohe_feat_manual, SparseVector),\n                'sample_one_ohe_feat_manual needs to be a SparseVector')\nTest.assertTrue(isinstance(sample_two_ohe_feat_manual, SparseVector),\n                'sample_two_ohe_feat_manual needs to be a SparseVector')\nTest.assertTrue(isinstance(sample_three_ohe_feat_manual, SparseVector),\n                'sample_three_ohe_feat_manual needs to be a SparseVector')\nTest.assertEqualsHashed(sample_one_ohe_feat_manual,\n                        'ecc00223d141b7bd0913d52377cee2cf5783abd6',\n                        'incorrect value for sample_one_ohe_feat_manual')\nTest.assertEqualsHashed(sample_two_ohe_feat_manual,\n                        '26b023f4109e3b8ab32241938e2e9b9e9d62720a',\n                        'incorrect value for sample_two_ohe_feat_manual')\nTest.assertEqualsHashed(sample_three_ohe_feat_manual,\n                        'c04134fd603ae115395b29dcabe9d0c66fbdc8a7',\n                        'incorrect value for sample_three_ohe_feat_manual')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747298799E12,"submitTime":1.46974729568E12,"finishTime":1.46974729884E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"136abcee-3409-42c8-bb9b-382e2a2a1ff9"},{"version":"CommandV1","origId":1641625786991685,"guid":"e6981bed-7e8e-4fcb-aa16-d25737e34e6c","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n### (1d) Define a OHE function\n\nNext we will use the OHE dictionary from Part (1a) to programatically generate OHE features from the original categorical data.  First write a function called `one_hot_encoding` that creates OHE feature vectors in `SparseVector` format.  Then use this function to create OHE features for the first sample data point and verify that the result matches the result from Part (1c).\n\n> Note: We'll pass in the OHE dictionary as a [Broadcast](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.Broadcast) variable, which will greatly improve performance when we call this function as part of a UDF. **When accessing a broadcast variable, you _must_ use `.value`.** For instance: `ohe_dict_broadcast.value`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295698E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ba574851-98df-4bd7-815b-b2fe91e1ed75"},{"version":"CommandV1","origId":1641625786991686,"guid":"92471ee0-f536-4cb9-a9c3-7b4f59410b6c","subtype":"command","commandType":"auto","position":20.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef one_hot_encoding(raw_feats, ohe_dict_broadcast, num_ohe_feats):\n    \"\"\"Produce a one-hot-encoding from a list of features and an OHE dictionary.\n\n    Note:\n        You should ensure that the indices used to create a SparseVector are sorted.\n\n    Args:\n        raw_feats (list of (int, str)): The features corresponding to a single observation.  Each\n            feature consists of a tuple of featureID and the feature's value. (e.g. sample_one)\n        ohe_dict_broadcast (Broadcast of dict): Broadcast variable containing a dict that maps\n            (featureID, value) to unique integer.\n        num_ohe_feats (int): The total number of unique OHE features (combinations of featureID and\n            value).\n\n    Returns:\n        SparseVector: A SparseVector of length num_ohe_feats with indices equal to the unique\n            identifiers for the (featureID, value) combinations that occur in the observation and\n            with values equal to 1.0.\n    \"\"\"\n    vec = []\n    for i in raw_feats:\n      vec.append(ohe_dict_broadcast.value[i])\n    vec = sorted(vec)\n    return SparseVector(num_ohe_feats,vec, np.ones(len(vec)))\n  \n\n# Calculate the number of features in sample_ohe_dict_manual\nnum_sample_ohe_feats = len(sample_ohe_dict_manual)\nsample_ohe_dict_manual_broadcast = sc.broadcast(sample_ohe_dict_manual)\n\n# Run one_hot_encoding() on sample_one.  Make sure to pass in the Broadcast variable.\nsample_one_ohe_feat = one_hot_encoding(sample_one,sample_ohe_dict_manual_broadcast,num_sample_ohe_feats)\n\nprint sample_one_ohe_feat","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(7,[2,3],[1.0,1.0])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: global name &apos;raw_feats_filtered_index&apos; is not defined","error":"<div class=\"ansiout\">Printing the raw features\n[(0, &apos;mouse&apos;), (1, &apos;black&apos;)]\n{(2, &apos;mouse&apos;): 5, (0, &apos;cat&apos;): 1, (0, &apos;bear&apos;): 0, (2, &apos;salmon&apos;): 6, (1, &apos;tabby&apos;): 4, (1, &apos;black&apos;): 3, (0, &apos;mouse&apos;): 2}\n<span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-107-0d75425d3989&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     34</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     35</span> <span class=\"ansired\"># Run one_hot_encoding() on sample_one.  Make sure to pass in the Broadcast variable.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 36</span><span class=\"ansiyellow\"> </span>sample_one_ohe_feat <span class=\"ansiyellow\">=</span> one_hot_encoding<span class=\"ansiyellow\">(</span>sample_one<span class=\"ansiyellow\">,</span>sample_ohe_dict_manual_broadcast<span class=\"ansiyellow\">,</span>num_sample_ohe_feats<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     37</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     38</span> <span class=\"ansigreen\">print</span> sample_one_ohe_feat<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-107-0d75425d3989&gt;</span> in <span class=\"ansicyan\">one_hot_encoding</span><span class=\"ansiblue\">(raw_feats, ohe_dict_broadcast, num_ohe_feats)</span>\n<span class=\"ansigreen\">     26</span>       vec<span class=\"ansiyellow\">.</span>append<span class=\"ansiyellow\">(</span>ohe_dict_broadcast<span class=\"ansiyellow\">.</span>value<span class=\"ansiyellow\">[</span>i<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     27</span>     vec <span class=\"ansiyellow\">=</span> sorted<span class=\"ansiyellow\">(</span>vec<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 28</span><span class=\"ansiyellow\">     </span><span class=\"ansigreen\">return</span> SparseVector<span class=\"ansiyellow\">(</span>num_ohe_feats<span class=\"ansiyellow\">,</span>raw_feats_filtered_index<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1.</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">*</span> len<span class=\"ansiyellow\">(</span>vec<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     29</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     30</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: global name &apos;raw_feats_filtered_index&apos; is not defined\n</div>","workflows":[],"startTime":1.469747298843E12,"submitTime":1.469747295723E12,"finishTime":1.469747298889E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3126b1a2-9fc6-420a-82ac-d06f442953ed"},{"version":"CommandV1","origId":1641625786991687,"guid":"315f440e-9768-404e-a225-2d21a947aaf5","subtype":"command","commandType":"auto","position":21.0,"command":"# TEST Define an OHE Function (1d)\nTest.assertTrue(sample_one_ohe_feat == sample_one_ohe_feat_manual,\n                'sample_one_ohe_feat should equal sample_one_ohe_feat_manual')\nTest.assertEquals(sample_one_ohe_feat, SparseVector(7, [2, 3], [1.0, 1.0]),\n                  'incorrect value for sample_one_ohe_feat')\nTest.assertEquals(one_hot_encoding([(1, 'black'), (0, 'mouse')], sample_ohe_dict_manual_broadcast,\n                                   num_sample_ohe_feats), SparseVector(7, [2, 3], [1.0, 1.0]),\n                  'incorrect definition for one_hot_encoding')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: len() of unsized object","error":"<div class=\"ansiout\">1 test passed.\n1 test passed.\nPrinting the raw features\n[(1, &apos;black&apos;), (0, &apos;mouse&apos;)]\n{(2, &apos;mouse&apos;): 5, (0, &apos;cat&apos;): 1, (0, &apos;bear&apos;): 0, (2, &apos;salmon&apos;): 6, (1, &apos;tabby&apos;): 4, (1, &apos;black&apos;): 3, (0, &apos;mouse&apos;): 2}\n<span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-105-1b1a77c68023&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      5</span>                   &apos;incorrect value for sample_one_ohe_feat&apos;)\n<span class=\"ansigreen\">      6</span> Test.assertEquals(one_hot_encoding([(1, &apos;black&apos;), (0, &apos;mouse&apos;)], sample_ohe_dict_manual_broadcast,\n<span class=\"ansigreen\">----&gt; 7</span><span class=\"ansiyellow\">                                    num_sample_ohe_feats), SparseVector(7, [2, 3], [1.0, 1.0]),\n</span><span class=\"ansigreen\">      8</span>                   &apos;incorrect definition for one_hot_encoding&apos;)\n\n<span class=\"ansigreen\">&lt;ipython-input-104-261e94c3142a&gt;</span> in <span class=\"ansicyan\">one_hot_encoding</span><span class=\"ansiblue\">(raw_feats, ohe_dict_broadcast, num_ohe_feats)</span>\n<span class=\"ansigreen\">     26</span>       vec<span class=\"ansiyellow\">.</span>append<span class=\"ansiyellow\">(</span>ohe_dict_broadcast<span class=\"ansiyellow\">.</span>value<span class=\"ansiyellow\">[</span>i<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     27</span>     vec <span class=\"ansiyellow\">=</span> sorted<span class=\"ansiyellow\">(</span>vec<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 28</span><span class=\"ansiyellow\">     </span><span class=\"ansigreen\">return</span> SparseVector<span class=\"ansiyellow\">(</span>num_ohe_feats<span class=\"ansiyellow\">,</span>vec<span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">2</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     29</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     30</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/mllib/linalg/__init__.py</span> in <span class=\"ansicyan\">__init__</span><span class=\"ansiblue\">(self, size, *args)</span>\n<span class=\"ansigreen\">    526</span>                 self<span class=\"ansiyellow\">.</span>indices <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>array<span class=\"ansiyellow\">(</span>args<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> dtype<span class=\"ansiyellow\">=</span>np<span class=\"ansiyellow\">.</span>int32<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    527</span>                 self<span class=\"ansiyellow\">.</span>values <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>array<span class=\"ansiyellow\">(</span>args<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> dtype<span class=\"ansiyellow\">=</span>np<span class=\"ansiyellow\">.</span>float64<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 528</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">assert</span> len<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>indices<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">==</span> len<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>values<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;index and value arrays not same length&quot;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    529</span>             <span class=\"ansigreen\">for</span> i <span class=\"ansigreen\">in</span> xrange<span class=\"ansiyellow\">(</span>len<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>indices<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">-</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    530</span>                 <span class=\"ansigreen\">if</span> self<span class=\"ansiyellow\">.</span>indices<span class=\"ansiyellow\">[</span>i<span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">&gt;=</span> self<span class=\"ansiyellow\">.</span>indices<span class=\"ansiyellow\">[</span>i <span class=\"ansiyellow\">+</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: len() of unsized object\n</div>","workflows":[],"startTime":1.469747298892E12,"submitTime":1.469747295742E12,"finishTime":1.469747298935E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9b6d8f25-0fda-4622-9b8c-fdd804126763"},{"version":"CommandV1","origId":1641625786991688,"guid":"9593c707-3320-4417-bc54-4ce2442985f1","subtype":"command","commandType":"auto","position":22.0,"command":"%md\n### (1e) Apply OHE to a dataset\n\nFinally, use the function from Part (1d) to create OHE features for all 3 data points in the sample dataset.  You'll need to generate a [UDF](https://spark.apache.org/docs/1.6.1/api/python/pyspark.sql.html#pyspark.sql.functions.udf) that can be used in a `DataFrame` `select` statement.\n\n> Note: Your implemenation of `ohe_udf_generator` needs to call your `one_hot_encoding` function.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295757E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"cd66f26f-3479-4dd4-ac59-b93be1438715"},{"version":"CommandV1","origId":1641625786991689,"guid":"d15f9129-5f85-4694-9cab-da3197312412","subtype":"command","commandType":"auto","position":23.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nfrom pyspark.sql.functions import udf\nfrom pyspark.mllib.linalg import VectorUDT\n\ndef ohe_udf_generator(ohe_dict_broadcast):\n    \"\"\"Generate a UDF that is setup to one-hot-encode rows with the given dictionary.\n\n    Note:\n        We'll reuse this function to generate a UDF that can one-hot-encode rows based on a\n        one-hot-encoding dictionary built from the training data.  Also, you should calculate\n        the number of features before calling the one_hot_encoding function.\n\n    Args:\n        ohe_dict_broadcast (Broadcast of dict): Broadcast variable containing a dict that maps\n            (featureID, value) to unique integer.\n\n    Returns:\n        UserDefinedFunction: A UDF can be used in `DataFrame` `select` statement to call a\n            function on each row in a given column.  This UDF should call the one_hot_encoding\n            function with the appropriate parameters.\n    \"\"\"\n    #print(ohe_dict_broadcast.value)\n    length = len(ohe_dict_broadcast.value)\n    return udf(lambda x: one_hot_encoding(x, ohe_dict_broadcast, length), VectorUDT())\n\nprint(sample_ohe_dict_manual_broadcast.value)\nsample_ohe_dict_udf = ohe_udf_generator(sample_ohe_dict_manual_broadcast)\nsample_ohe_df = sample_data_df.select(sample_ohe_dict_udf(sample_data_df.features))\nsample_ohe_df.show(truncate=False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">{(2, &apos;mouse&apos;): 5, (0, &apos;cat&apos;): 1, (0, &apos;bear&apos;): 0, (2, &apos;salmon&apos;): 6, (1, &apos;tabby&apos;): 4, (1, &apos;black&apos;): 3, (0, &apos;mouse&apos;): 2}\n+----------------------------+\n|PythonUDF#&lt;lambda&gt;(features)|\n+----------------------------+\n|(7,[2,3],[1.0,1.0])         |\n|(7,[1,4,5],[1.0,1.0,1.0])   |\n|(7,[0,3,6],[1.0,1.0,1.0])   |\n+----------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747298939E12,"submitTime":1.469747295777E12,"finishTime":1.469747299317E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2a064454-812a-4f93-8172-fc844fe49e13"},{"version":"CommandV1","origId":1641625786991690,"guid":"91ffcfc3-2270-4cba-bd80-24c8abb19a1d","subtype":"command","commandType":"auto","position":24.0,"command":"# TEST Apply OHE to a dataset (1e)\nsample_ohe_data_values = sample_ohe_df.collect()\nTest.assertTrue(len(sample_ohe_data_values) == 3, 'sample_ohe_data_values should have three elements')\nTest.assertEquals(sample_ohe_data_values[0], (SparseVector(7, {2: 1.0, 3: 1.0}),),\n                  'incorrect OHE for first sample')\nTest.assertEquals(sample_ohe_data_values[1], (SparseVector(7, {1: 1.0, 4: 1.0, 5: 1.0}),),\n                  'incorrect OHE for second sample')\nTest.assertEquals(sample_ohe_data_values[2], (SparseVector(7, {0: 1.0, 3: 1.0, 6: 1.0}),),\n                  'incorrect OHE for third sample')\nTest.assertTrue('one_hot_encoding' in sample_ohe_dict_udf.func.func_code.co_names,\n                'ohe_udf_generator should call one_hot_encoding')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747299321E12,"submitTime":1.469747295791E12,"finishTime":1.469747299549E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"81e14122-942e-4042-a4b0-7fd5cb51ac1a"},{"version":"CommandV1","origId":1641625786991691,"guid":"bf6058ee-6c38-44da-b82d-f8378c7cd8b7","subtype":"command","commandType":"auto","position":25.0,"command":"%md\n## Part 2: Construct an OHE dictionary","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295805E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0f43fbd3-0058-40de-9b11-3309ff2a3984"},{"version":"CommandV1","origId":1641625786991692,"guid":"4d2a2c12-4134-4d47-9f22-7934c82d69c4","subtype":"command","commandType":"auto","position":26.0,"command":"%md\n### (2a) DataFrame with rows of `(featureID, category)`\n\nTo start, create a DataFrame of distinct `(feature_id, category)` tuples. In our sample dataset, the 7 items in the resulting DataFrame are `(0, 'bear')`, `(0, 'cat')`, `(0, 'mouse')`, `(1, 'black')`, `(1, 'tabby')`, `(2, 'mouse')`, `(2, 'salmon')`. Notably `'black'` appears twice in the dataset but only contributes one item to the DataFrame: `(1, 'black')`, while `'mouse'` also appears twice and contributes two items: `(0, 'mouse')` and `(2, 'mouse')`.  Use [explode](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.explode) and [distinct](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.distinct).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.46974729583E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7cb5f193-29e3-418d-a50f-700efa5bdec5"},{"version":"CommandV1","origId":1641625786991693,"guid":"ec402dca-a249-4251-b9a5-f307027a775a","subtype":"command","commandType":"auto","position":27.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nfrom pyspark.sql.functions import explode\nsample_data_df.show(1,truncate=False)\nsample_data_df.select(explode('features')).show(1,truncate=False)\nsample_distinct_feats_df = (sample_data_df.select(explode(\"features\")).distinct())\nsample_distinct_feats_df.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------------------+\n|features              |\n+----------------------+\n|[[0,mouse], [1,black]]|\n+----------------------+\nonly showing top 1 row\n\n+---------+\n|col      |\n+---------+\n|[0,mouse]|\n+---------+\nonly showing top 1 row\n\n+----------+\n|       col|\n+----------+\n|  [0,bear]|\n| [0,mouse]|\n| [1,black]|\n| [1,tabby]|\n|[2,salmon]|\n| [2,mouse]|\n|   [0,cat]|\n+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747299552E12,"submitTime":1.469747295861E12,"finishTime":1.469747300029E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c79ec99c-0a19-458f-83c1-f1287acd1718"},{"version":"CommandV1","origId":1641625786991694,"guid":"a623fd21-37bd-4e96-9d48-0783d7c6ae6d","subtype":"command","commandType":"auto","position":28.0,"command":"# TEST DataFrame with rows of `(featureID, category)` (2a)\nTest.assertEquals(sorted(map(lambda r: r[0], sample_distinct_feats_df.collect())),\n                  [(0, 'bear'), (0, 'cat'), (0, 'mouse'), (1, 'black'),\n                   (1, 'tabby'), (2, 'mouse'), (2, 'salmon')],\n                  'incorrect value for sample_distinct_feats_df')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747300034E12,"submitTime":1.469747295874E12,"finishTime":1.46974730021E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"142ecd55-d696-4d1e-b0db-4dcf367aaefc"},{"version":"CommandV1","origId":1641625786991695,"guid":"df7c4d43-e752-45a5-9cba-60334bce3a7a","subtype":"command","commandType":"auto","position":29.0,"command":"%md\n### (2b) OHE Dictionary from distinct features\n\nNext, create an RDD of key-value tuples, where each `(feature_id, category)` tuple in `sample_distinct_feats_df` is a key and the values are distinct integers ranging from 0 to (number of keys - 1).  Then convert this RDD into a dictionary, which can be done using the `collectAsMap` action.  Note that there is no unique mapping from keys to values, as all we require is that each `(featureID, category)` key be mapped to a unique integer between 0 and the number of keys.  In this exercise, any valid mapping is acceptable.  Use [zipWithIndex](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.zipWithIndex) followed by [collectAsMap](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.collectAsMap).\n\nIn our sample dataset, one valid list of key-value tuples is: `[((0, 'bear'), 0), ((2, 'salmon'), 1), ((1, 'tabby'), 2), ((2, 'mouse'), 3), ((0, 'mouse'), 4), ((0, 'cat'), 5), ((1, 'black'), 6)]`. The dictionary defined in Part (1a) illustrates another valid mapping between keys and integers.\n\n> Note: We provide the code to convert the DataFrame to an RDD.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295888E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"105c7ac4-3922-4e11-b661-a01c7ebc966e"},{"version":"CommandV1","origId":1781929634056974,"guid":"fc776bce-4982-4ce4-af02-2cdd4aef93e0","subtype":"command","commandType":"auto","position":29.5,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"33a25204-1286-404b-b9d8-80bf1fa04e40"},{"version":"CommandV1","origId":1641625786991696,"guid":"b5b357a3-b3c3-45c1-8807-49bcd274d72d","subtype":"command","commandType":"auto","position":30.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nsample_ohe_dict = (sample_distinct_feats_df\n                     .rdd\n                     .map(lambda r: tuple(r[0])).zipWithIndex().collectAsMap())\nprint sample_ohe_dict","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">{(2, u&apos;mouse&apos;): 5, (0, u&apos;cat&apos;): 6, (0, u&apos;bear&apos;): 0, (2, u&apos;salmon&apos;): 4, (1, u&apos;tabby&apos;): 3, (1, u&apos;black&apos;): 2, (0, u&apos;mouse&apos;): 1}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747300213E12,"submitTime":1.469747295923E12,"finishTime":1.469747300437E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0e5420e9-3a95-4aa0-bb52-72e1573b3617"},{"version":"CommandV1","origId":1641625786991697,"guid":"fcf435b9-077d-4a1d-9049-b6da0b4fc4cb","subtype":"command","commandType":"auto","position":31.0,"command":"# TEST OHE Dictionary from distinct features (2b)\nTest.assertEquals(sorted(sample_ohe_dict.keys()),\n                  [(0, 'bear'), (0, 'cat'), (0, 'mouse'), (1, 'black'),\n                   (1, 'tabby'), (2, 'mouse'), (2, 'salmon')],\n                  'sample_ohe_dict has unexpected keys')\nTest.assertEquals(sorted(sample_ohe_dict.values()), range(7), 'sample_ohe_dict has unexpected values')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46974730044E12,"submitTime":1.469747295938E12,"finishTime":1.469747300459E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8169d867-4382-4135-8ee3-dc061b71113b"},{"version":"CommandV1","origId":1641625786991698,"guid":"c484032b-93c0-4325-bf3c-ca4b55ef6fe0","subtype":"command","commandType":"auto","position":32.0,"command":"%md\n### (2c) Automated creation of an OHE dictionary\n\nNow use the code from Parts (2a) and (2b) to write a function that takes an input dataset and outputs an OHE dictionary.  Then use this function to create an OHE dictionary for the sample dataset, and verify that it matches the dictionary from Part (2b).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295952E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ba2921a3-3242-4085-aac4-7c0044c868e4"},{"version":"CommandV1","origId":1641625786991699,"guid":"73bad890-1f22-4b18-b37b-db7f0a73d78e","subtype":"command","commandType":"auto","position":33.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef create_one_hot_dict(input_df):\n    \"\"\"Creates a one-hot-encoder dictionary based on the input data.\n\n    Args:\n        input_df (DataFrame with 'features' column): A DataFrame where each row contains a list of\n            (featureID, value) tuples.\n\n    Returns:\n        dict: A dictionary where the keys are (featureID, value) tuples and map to values that are\n            unique integers.\n    \"\"\"\n    distinct_data = (input_df.select(explode(\"features\")).distinct().rdd\n                     .map(lambda r: tuple(r[0])).zipWithIndex().collectAsMap())\n    return distinct_data\n    \n    \nsample_ohe_dict_auto = create_one_hot_dict(sample_data_df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747300462E12,"submitTime":1.469747295971E12,"finishTime":1.469747300838E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"220dd7e7-8a07-4e44-b110-9bd8a7733ee2"},{"version":"CommandV1","origId":1641625786991700,"guid":"9e2e26ed-7e8e-407b-9b2b-d6c18cf1315f","subtype":"command","commandType":"auto","position":34.0,"command":"# TEST Automated creation of an OHE dictionary (2c)\nTest.assertEquals(sorted(sample_ohe_dict_auto.keys()),\n                  [(0, 'bear'), (0, 'cat'), (0, 'mouse'), (1, 'black'),\n                   (1, 'tabby'), (2, 'mouse'), (2, 'salmon')],\n                  'sample_ohe_dict_auto has unexpected keys')\nTest.assertEquals(sorted(sample_ohe_dict_auto.values()), range(7),\n                  'sample_ohe_dict_auto has unexpected values')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747300841E12,"submitTime":1.469747295984E12,"finishTime":1.469747300915E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1e9659ba-496c-4193-9311-cec091d327d4"},{"version":"CommandV1","origId":1641625786991701,"guid":"9fe245b6-2934-4027-977a-eaebb18399c7","subtype":"command","commandType":"auto","position":35.0,"command":"%md\n## Part 3: Parse CTR data and generate OHE features","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747295996E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5b8d3cf1-13a5-4a24-a54f-10af736f958c"},{"version":"CommandV1","origId":1641625786991702,"guid":"3bb5b57d-3882-48a1-bacd-f571df83e4c8","subtype":"command","commandType":"auto","position":36.0,"command":"%md\nBefore we can proceed, you'll first need to obtain the data from Criteo.  Here is the link to Criteo's data sharing agreement: <a href=\"http://labs.criteo.com/downloads/2014-kaggle-display-advertising-challenge-dataset/\" target=\"criteo\">http://labs.criteo.com/downloads/2014-kaggle-display-advertising-challenge-dataset/</a>.  After you accept the agreement, you can obtain the download URL by right-clicking on the \"**Download Sample**\" button and clicking \"Copy link address\" or \"Copy Link Location\", depending on your browser.\n\n* Run the cell containing the `download_criteo()` function.\n* Paste the URL into the `TODO` cell below that cell. Then, run the cell. It will download the data and make it available as a DataFrame, in variable `raw_df`.\n\nNote that the download should complete within 30 seconds.\n\n**WARNING: Be sure you get the \"Download Sample\" link, _not_ the \"Download\" link!**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296017E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6d007647-8b92-4b06-a222-870522353bb6"},{"version":"CommandV1","origId":1641625786991703,"guid":"dd5996d6-e59f-4c70-9212-f50ff8f42e46","subtype":"command","commandType":"auto","position":37.0,"command":"# Nothing to edit here. Just run this cell.\n\ndef cleanup_old_downloads():\n  from fnmatch import fnmatch\n\n  # Clean up old downloaded files from dbfs:/tmp to prevent QUOTA_EXCEEDED errors.\n  for f in dbutils.fs.ls('/tmp'):\n    name = str(f.name)\n    if fnmatch(name, 'criteo_*'):\n      dbutils.fs.rm(str(f.path), recurse=True)\n\ndef download_criteo(url):\n  from io import BytesIO\n  import urllib2\n  import tarfile\n  import uuid\n  import tempfile\n  import random\n  import string\n  import os\n\n  if not url.endswith('dac_sample.tar.gz'):\n    raise Exception('Check your download URL. Are you downloading the sample dataset?')\n\n  cleanup_old_downloads()\n\n  # Create a random ID for the directory containing the downloaded file, to avoid any name clashes\n  # with any other clusters. (Might not be necessary, but, safety first...)\n  rng = random.SystemRandom()\n  tlds = ('.org', '.net', '.com', '.info', '.biz')\n  random_domain_name = (\n    ''.join(rng.choice(string.letters + string.digits) for i in range(64)) +\n    rng.choice(tlds)\n  )\n  random_id = str(uuid.uuid3(uuid.NAMESPACE_DNS, random_domain_name)).replace('-', '_')\n  unique_id = str(uuid.uuid3(uuid.NAMESPACE_DNS, random_id)).replace('-', '_')\n  dbfs_dir  = 'dbfs:/tmp/criteo_{0}'.format(unique_id)\n  dbfs_path = '{0}/data.txt'.format(dbfs_dir)\n  dbutils.fs.mkdirs(dbfs_dir)\n\n  # Download the tarball and unpack it.\n  tmp = BytesIO()\n  req = urllib2.Request(url, headers={'User-Agent': 'Databricks'})\n  url_handle = urllib2.urlopen(req)\n  tmp.write(url_handle.read())\n  tmp.seek(0)\n  tf = tarfile.open(fileobj=tmp)\n  dac_sample = tf.extractfile('dac_sample.txt')\n  dac_sample = '\\n'.join([unicode(x.replace('\\n', '').replace('\\t', ',')) for x in dac_sample])\n\n  # Write the downloaded data to to dbfs:/tmp.\n  with tempfile.NamedTemporaryFile(mode='wb', delete=False, prefix='dac', suffix='.txt') as t:\n    t.write(dac_sample)\n    t.close()\n    dbutils.fs.cp('file://{0}'.format(t.name), dbfs_path)\n    os.unlink(t.name)\n\n  return dbfs_path","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747300918E12,"submitTime":1.46974729604E12,"finishTime":1.469747301003E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"820f8432-8369-45aa-a969-70c1f247858d"},{"version":"CommandV1","origId":1641625786991704,"guid":"1983634f-a0af-4a17-abc0-c2b5f2a91ba4","subtype":"command","commandType":"auto","position":38.0,"command":"# TODO: Replace <FILL IN> with the appropriate URL. Then, run the following cell\n# to download the data.\ncriteo_url = 'http://criteolabs.wpengine.com/wp-content/uploads/2015/04/dac_sample.tar.gz'","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747301006E12,"submitTime":1.469747296055E12,"finishTime":1.469747301047E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"61c01a84-1b59-4976-89ae-d5b02457d5ca"},{"version":"CommandV1","origId":1641625786991705,"guid":"2eed92e3-530f-49c5-8961-8b9dce7ee135","subtype":"command","commandType":"auto","position":39.0,"command":"# Run this cell after you have filled in criteo_url.\n\nif ('downloaded_data_file' not in locals()) or (downloaded_data_file is None):\n  downloaded_data_file = download_criteo(criteo_url)\n\nif ('raw_df' in locals()) and (raw_df is not None):\n  print \"raw_df is already loaded. Nothing to do. (Set raw_df=None to reload it, then re-run this cell.)\"\nelse:\n  raw_df = sqlContext.read.text(downloaded_data_file).withColumnRenamed(\"value\", \"text\")\n\nprint \"raw_df initialized to read from {0}\".format(downloaded_data_file)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">raw_df is already loaded. Nothing to do. (Set raw_df=None to reload it, then re-run this cell.)\nraw_df initialized to read from dbfs:/tmp/criteo_c6b6fb68_a210_3189_9042_73eada877675/data.txt\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46974730105E12,"submitTime":1.469747296069E12,"finishTime":1.469747301092E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6813842f-8e39-4086-8b1a-2b34fc3c60c0"},{"version":"CommandV1","origId":1641625786991706,"guid":"ef6f9e60-465a-49d0-a29a-8d32843c0c1f","subtype":"command","commandType":"auto","position":40.0,"command":"raw_df.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+\n|                text|\n+--------------------+\n|0,1,1,5,0,1382,4,...|\n|0,2,0,44,1,102,8,...|\n|0,2,0,1,14,767,89...|\n|0,,893,,,4392,,0,...|\n|0,3,-1,,0,2,0,3,0...|\n|0,,-1,,,12824,,0,...|\n|0,,1,2,,3168,,0,1...|\n|1,1,4,2,0,0,0,1,0...|\n|0,,44,4,8,19010,2...|\n|0,,35,,1,33737,21...|\n|0,,2,632,0,56770,...|\n|0,0,6,6,6,421,109...|\n|1,0,-1,,,1465,0,1...|\n|1,,2,11,5,10262,3...|\n|0,0,51,84,4,3633,...|\n|0,,2,1,18,20255,,...|\n|1,1,987,,2,105,2,...|\n|0,0,1,,0,16597,55...|\n|0,0,24,4,2,2056,1...|\n|0,7,102,,3,780,15...|\n+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747301095E12,"submitTime":1.469747296084E12,"finishTime":1.469747301468E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2fc794c6-9307-4c2f-a303-5905817e938d"},{"version":"CommandV1","origId":1641625786991707,"guid":"807cee62-b779-4f0c-a40f-7fa5e9d33641","subtype":"command","commandType":"auto","position":41.0,"command":"%md\n### (3a) Loading and splitting the data\n\nWe are now ready to start working with the actual CTR data, and our first task involves splitting it into training, validation, and test sets.  Use the [randomSplit method](https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.randomSplit) with the specified weights and seed to create DFs storing each of these datasets, and then [cache](https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.cache) each of these DFs, as we will be accessing them multiple times in the remainder of this lab. Finally, compute the size of each dataset.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296096E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b95ca0f9-b9a5-4252-9a42-1384d6f52d65"},{"version":"CommandV1","origId":1641625786991708,"guid":"c1854d3f-186d-4535-9d5d-fb0040e74c06","subtype":"command","commandType":"auto","position":42.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nweights = [.8, .1, .1]\nseed = 42\n\n# Use randomSplit with weights and seed\nraw_train_df, raw_validation_df, raw_test_df = raw_df.randomSplit(weights,seed)\n\n# Cache and count the DataFrames\nn_train = raw_train_df.count()\nn_val = raw_validation_df.count()\nn_test = raw_test_df.count()\n\nraw_train_df.cache()\nraw_validation_df.cache()\nraw_test_df.cache()\n\nprint n_train, n_val, n_test, n_train + n_val + n_test\nraw_df.show(1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">80178 9887 9935 100000\n+--------------------+\n|                text|\n+--------------------+\n|0,1,1,5,0,1382,4,...|\n+--------------------+\nonly showing top 1 row\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747301471E12,"submitTime":1.469747296117E12,"finishTime":1.469747301999E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ed30b91f-d9ec-4459-9e38-d5f4b4358f9e"},{"version":"CommandV1","origId":1641625786991709,"guid":"99e68720-7c38-4810-b9ba-35d7aae4965d","subtype":"command","commandType":"auto","position":43.0,"command":"# TEST Loading and splitting the data (3a)\n\nTest.assertTrue(all([raw_train_df.is_cached, raw_validation_df.is_cached, raw_test_df.is_cached]),\n                'you must cache the split data')\nTest.assertEquals(n_train, 80178, 'incorrect value for n_train')\nTest.assertEquals(n_val, 9887, 'incorrect value for n_val')\nTest.assertEquals(n_test, 9935, 'incorrect value for n_test')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747302002E12,"submitTime":1.46974729613E12,"finishTime":1.469747302042E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c34b358c-2f22-4291-9e29-c00bd2e02b45"},{"version":"CommandV1","origId":1641625786991710,"guid":"9eb35a6c-cd6d-4815-8bc6-e2cb3af52409","subtype":"command","commandType":"auto","position":44.0,"command":"%md\n### (3b) Extract features\n\nWe will now parse the raw training data to create a DataFrame that we can subsequently use to create an OHE dictionary. Note from the `show()` command in Part (3a) that each raw data point is a string containing several fields separated by some delimiter.  For now, we will ignore the first field (which is the 0-1 label), and parse the remaining fields (or raw features).  To do this, complete the implemention of the `parse_point` function.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296144E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e781d591-dbc6-42d7-9c3b-ccdfc67e6cc3"},{"version":"CommandV1","origId":1641625786991711,"guid":"e1a8d2fd-f3c7-4135-af96-71238f2bc99c","subtype":"command","commandType":"auto","position":45.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef parse_point(point):\n    \"\"\"Converts a comma separated string into a list of (featureID, value) tuples.\n\n    Note:\n        featureIDs should start at 0 and increase to the number of features - 1.\n\n    Args:\n        point (str): A comma separated string where the first value is the label and the rest\n            are features.\n\n    Returns:\n        list: A list of (featureID, value) tuples.\n    \"\"\"\n    x = [(i,value) for i, value in enumerate(point.split(',')[1:])]\n    return x\n    \nprint parse_point(raw_df.select('text').first()[0])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[(0, u&apos;1&apos;), (1, u&apos;1&apos;), (2, u&apos;5&apos;), (3, u&apos;0&apos;), (4, u&apos;1382&apos;), (5, u&apos;4&apos;), (6, u&apos;15&apos;), (7, u&apos;2&apos;), (8, u&apos;181&apos;), (9, u&apos;1&apos;), (10, u&apos;2&apos;), (11, u&apos;&apos;), (12, u&apos;2&apos;), (13, u&apos;68fd1e64&apos;), (14, u&apos;80e26c9b&apos;), (15, u&apos;fb936136&apos;), (16, u&apos;7b4723c4&apos;), (17, u&apos;25c83c98&apos;), (18, u&apos;7e0ccccf&apos;), (19, u&apos;de7995b8&apos;), (20, u&apos;1f89b562&apos;), (21, u&apos;a73ee510&apos;), (22, u&apos;a8cd5504&apos;), (23, u&apos;b2cb9c98&apos;), (24, u&apos;37c9c164&apos;), (25, u&apos;2824a5f6&apos;), (26, u&apos;1adce6ef&apos;), (27, u&apos;8ba8b39a&apos;), (28, u&apos;891b62e7&apos;), (29, u&apos;e5ba7672&apos;), (30, u&apos;f54016b9&apos;), (31, u&apos;21ddcdc9&apos;), (32, u&apos;b1252a9d&apos;), (33, u&apos;07b5194c&apos;), (34, u&apos;&apos;), (35, u&apos;3a171ecb&apos;), (36, u&apos;c5c50484&apos;), (37, u&apos;e8b83407&apos;), (38, u&apos;9727dd16&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747302045E12,"submitTime":1.469747296167E12,"finishTime":1.469747302269E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6210552d-4508-4fe1-9524-33f13fefdc12"},{"version":"CommandV1","origId":1641625786991712,"guid":"cfb3d7b8-3b13-44a2-88e9-70f785130a46","subtype":"command","commandType":"auto","position":46.0,"command":"# TEST Extract features (3b)\nTest.assertEquals(parse_point(raw_df.select('text').first()[0])[:3], [(0, u'1'), (1, u'1'), (2, u'5')],\n                  'incorrect implementation of parse_point')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747302272E12,"submitTime":1.46974729618E12,"finishTime":1.469747302494E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"55529762-2b3b-475a-97b2-0edab495090e"},{"version":"CommandV1","origId":1641625786991713,"guid":"14091f6e-781f-4802-b92e-dfdba0398cc9","subtype":"command","commandType":"auto","position":47.0,"command":"%md\n### (3c) Extracting features continued\n\nNext, we'll create a `parse_raw_df` function that creates a `label` column from the first value in the text and a `feature` column from the rest of the values.  The `feature` column will be created using `parse_point_udf`, which we've provided and is based on your `parse_point` function.  Note that to name your columns you should use [alias](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.Column.alias).  You can split the `text` field in `raw_df` using [split](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.split) and retrieve the first value of the resulting array with [getItem](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.Column.getItem). Be sure to call [cast](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.Column.cast) to cast the column value to `double`. Your `parse_raw_df` function should also cache the DataFrame it returns.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296192E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"385f8a7c-cb5b-433e-8d10-1b8a82648689"},{"version":"CommandV1","origId":1641625786991714,"guid":"7bcd4761-fc6b-44ad-bc66-0c8f86086b5f","subtype":"command","commandType":"auto","position":48.0,"command":"# TODO: Replace <FILL IN> with the appropriate code\nimport sys\nfrom pyspark.sql.functions import udf, split\nfrom pyspark.sql.types import ArrayType, StructType, StructField, LongType, StringType\n\nparse_point_udf = udf(parse_point, ArrayType(StructType([StructField('_1', LongType()),\n                                                         StructField('_2', StringType())])))\n\ndef parse_raw_df(raw_df):\n    \"\"\"Convert a DataFrame consisting of rows of comma separated text into labels and feature.\n\n\n    Args:\n        raw_df (DataFrame with a 'text' column): DataFrame containing the raw comma separated data.\n\n    Returns:\n        DataFrame: A DataFrame with 'label' and 'feature' columns.\n    \"\"\"\n    data = raw_df.select(split(raw_df.text,',').getItem(0).cast('double').alias('label'),\n                        parse_point_udf(raw_df.text).alias('features'))\n    return data\n    \n# Parse the raw training DataFrame\nparsed_train_df = parse_raw_df(raw_train_df).cache()\n\nfrom pyspark.sql.functions import (explode, col)\nnum_categories = (parsed_train_df\n                    .select(explode('features').alias('feature'))\n                    .distinct()\n                    .select(col('feature').getField('_1').alias('featureNumber'))\n                    .groupBy('featureNumber')\n                    .sum()\n                    .orderBy('featureNumber')\n                    .collect())\n\nprint num_categories[2][1]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1706\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747302497E12,"submitTime":1.469747296215E12,"finishTime":1.469747308677E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"319f106e-ceec-49e7-92e7-6ae5f62a6a83"},{"version":"CommandV1","origId":1641625786991715,"guid":"f05ddeeb-d6f2-4ab7-acc9-32c4775abd64","subtype":"command","commandType":"auto","position":49.0,"command":"# TEST Extract features (3c)\nTest.assertTrue(parsed_train_df.is_cached, 'parse_raw_df should return a cached DataFrame')\nTest.assertEquals(num_categories[2][1], 1706, 'incorrect implementation of parse_point or parse_raw_df')\nTest.assertEquals(num_categories[32][1], 128, 'incorrect implementation of parse_point or parse_raw_df')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46974730868E12,"submitTime":1.469747296227E12,"finishTime":1.469747308704E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4f60061e-8636-43bd-b04c-4d20036167b1"},{"version":"CommandV1","origId":1641625786991716,"guid":"af892384-eb9c-4f17-a916-867da3b2094c","subtype":"command","commandType":"auto","position":50.0,"command":"%md\n### (3d) Create an OHE dictionary from the dataset\n\nNote that `parse_point` returns a data point as a list of `(featureID, category)` tuples, which is the same format as the sample dataset studied in Parts 1 and 2 of this lab.  Using this observation, create an OHE dictionary from the parsed training data using the function implemented in Part (2c). Note that we will assume for simplicity that all features in our CTR dataset are categorical.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296239E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c7c024f0-e23a-46a4-af32-256250406622"},{"version":"CommandV1","origId":1641625786991717,"guid":"d1a23486-a045-4174-9bf7-add83cf77dcb","subtype":"command","commandType":"auto","position":51.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nctr_ohe_dict = create_one_hot_dict(parsed_train_df)\nnum_ctr_ohe_feats = len(ctr_ohe_dict)\nprint num_ctr_ohe_feats\nprint ctr_ohe_dict[(0, '')]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">233941\n194837\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747308707E12,"submitTime":1.469747296265E12,"finishTime":1.469747312167E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c49778f0-d12a-4e7a-8a52-9d5c07f1715a"},{"version":"CommandV1","origId":1641625786991718,"guid":"36700494-37fe-4ba8-b07c-0a56ee59296a","subtype":"command","commandType":"auto","position":52.0,"command":"# TEST Create an OHE dictionary from the dataset (3d)\nTest.assertEquals(num_ctr_ohe_feats, 233941, 'incorrect number of features in ctr_ohe_dict')\nTest.assertTrue((0, '') in ctr_ohe_dict, 'incorrect features in ctr_ohe_dict')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46974731217E12,"submitTime":1.469747296278E12,"finishTime":1.469747312195E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3531c743-b548-4921-b9c2-7a3a652cfe97"},{"version":"CommandV1","origId":1641625786991719,"guid":"c1230bc4-dfac-4e32-9c40-143c81606396","subtype":"command","commandType":"auto","position":53.0,"command":"%md\n### (3e) Apply OHE to the dataset\n\nNow let's use this OHE dictionary, by starting with the training data that we've parsed into `label` and `feature` columns, to create one-hot-encoded features.  Recall that we created a function `ohe_udf_generator` that can create the UDF that we need to convert row into `features`.  Make sure that `ohe_train_df` contains a `label` and `features` column and is cached.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.46974729629E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2415ce88-9a9a-4832-9ea3-4930851809f9"},{"version":"CommandV1","origId":1641625786991720,"guid":"08914511-e144-4e08-aea0-4de5871bfd8e","subtype":"command","commandType":"auto","position":54.0,"command":"# TODO: Replace <FILL IN> with the appropriate code\nohe_dict_broadcast = sc.broadcast(ctr_ohe_dict)\nohe_dict_udf = ohe_udf_generator(ohe_dict_broadcast)\nohe_train_df = parsed_train_df.select('label',ohe_dict_udf(parsed_train_df['features']).alias('features')).cache()\n\nprint ohe_train_df.count()\nprint ohe_train_df.take(1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">80178\n[Row(label=0.0, features=SparseVector(233941, {0: 1.0, 1: 1.0, 39036: 1.0, 39037: 1.0, 39038: 1.0, 39039: 1.0, 39040: 1.0, 39041: 1.0, 39042: 1.0, 39043: 1.0, 39044: 1.0, 39045: 1.0, 39046: 1.0, 39047: 1.0, 77792: 1.0, 77793: 1.0, 77794: 1.0, 77795: 1.0, 77796: 1.0, 77797: 1.0, 77798: 1.0, 116844: 1.0, 116845: 1.0, 116846: 1.0, 116847: 1.0, 155823: 1.0, 155824: 1.0, 155825: 1.0, 155826: 1.0, 155827: 1.0, 155828: 1.0, 155829: 1.0, 155830: 1.0, 194837: 1.0, 194838: 1.0, 194839: 1.0, 194840: 1.0, 194841: 1.0, 194842: 1.0}))]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.469747312198E12,"submitTime":1.469747296318E12,"finishTime":1.469747324277E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"18b0682e-9fe3-4f50-b50e-884a68d94726"},{"version":"CommandV1","origId":1641625786991721,"guid":"9faee74a-4bfa-4fca-ba4d-4d7aee37d121","subtype":"command","commandType":"auto","position":55.0,"command":"# TEST Apply OHE to the dataset (3e)\nTest.assertTrue('label' in ohe_train_df.columns and 'features' in ohe_train_df.columns, 'ohe_train_df should have label and features columns')\nTest.assertTrue(ohe_train_df.is_cached, 'ohe_train_df should be cached')\nnum_nz = sum(parsed_train_df.rdd.map(lambda r: len(r[1])).take(5))\nnum_nz_alt = sum(ohe_train_df.rdd.map(lambda r: len(r[1].indices)).take(5))\nTest.assertEquals(num_nz, num_nz_alt, 'incorrect value for ohe_train_df')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747324279E12,"submitTime":1.469747296331E12,"finishTime":1.4697473244E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0b838c11-3b09-4afd-8ded-0126d38ffdfb"},{"version":"CommandV1","origId":1641625786991722,"guid":"e7d923fb-9ef6-434a-9161-283093d1343e","subtype":"command","commandType":"auto","position":56.0,"command":"%md\n### Visualization 1: Feature frequency\n\nWe will now visualize the number of times each of the 233,286 OHE features appears in the training data. We first compute the number of times each feature appears, then bucket the features by these counts.  The buckets are sized by powers of 2, so the first bucket corresponds to features that appear exactly once ( \\\\( \\scriptsize 2^0 \\\\) ), the second to features that appear twice ( \\\\( \\scriptsize 2^1 \\\\) ), the third to features that occur between three and four ( \\\\( \\scriptsize 2^2 \\\\) ) times, the fifth bucket is five to eight ( \\\\( \\scriptsize 2^3 \\\\) ) times and so on. The scatter plot below shows the logarithm of the bucket thresholds versus the logarithm of the number of features that have counts that fall in the buckets.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296344E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"bd2ed978-d097-4983-82a4-0b1aba7f765a"},{"version":"CommandV1","origId":1641625786991723,"guid":"84e92dfa-17c4-4d65-9131-08978ba3432a","subtype":"command","commandType":"auto","position":57.0,"command":"from pyspark.sql.types import ArrayType, IntegerType\nfrom pyspark.sql.functions import log\n\nget_indices = udf(lambda sv: map(int, sv.indices), ArrayType(IntegerType()))\nfeature_counts = (ohe_train_df\n                   .select(explode(get_indices('features')))\n                   .groupBy('col')\n                   .count()\n                   .withColumn('bucket', log('count').cast('int'))\n                   .groupBy('bucket')\n                   .count()\n                   .orderBy('bucket')\n                   .collect())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747324403E12,"submitTime":1.469747296362E12,"finishTime":1.469747331242E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8613fa83-105a-4592-9cb4-a272823c82be"},{"version":"CommandV1","origId":1641625786991724,"guid":"cfae6a75-a488-4cdf-840d-88f3f8f6e184","subtype":"command","commandType":"auto","position":58.0,"command":"import matplotlib.pyplot as plt\n\nx, y = zip(*feature_counts)\nx, y = x, np.log(y)\n\ndef prepare_plot(xticks, yticks, figsize=(10.5, 6), hide_labels=False, grid_color='#999999',\n                 grid_width=1.0):\n    \"\"\"Template for generating the plot layout.\"\"\"\n    plt.close()\n    fig, ax = plt.subplots(figsize=figsize, facecolor='white', edgecolor='white')\n    ax.axes.tick_params(labelcolor='#999999', labelsize='10')\n    for axis, ticks in [(ax.get_xaxis(), xticks), (ax.get_yaxis(), yticks)]:\n        axis.set_ticks_position('none')\n        axis.set_ticks(ticks)\n        axis.label.set_color('#999999')\n        if hide_labels: axis.set_ticklabels([])\n    plt.grid(color=grid_color, linewidth=grid_width, linestyle='-')\n    map(lambda position: ax.spines[position].set_visible(False), ['bottom', 'top', 'left', 'right'])\n    return fig, ax\n\n# generate layout and plot data\nfig, ax = prepare_plot(np.arange(0, 12, 1), np.arange(0, 14, 2))\nax.set_xlabel(r'$\\log_e(bucketSize)$'), ax.set_ylabel(r'$\\log_e(countInBucket)$')\nplt.scatter(x, y, s=14**2, c='#d6ebf2', edgecolors='#8cbfd0', alpha=0.75)\ndisplay(fig)","commandVersion":0,"state":"finished","results":{"type":"image","data":"data:image/png;base64,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","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747331245E12,"submitTime":1.469747296378E12,"finishTime":1.469747332197E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a63a1abf-5405-446e-8b90-9d2301133a1d"},{"version":"CommandV1","origId":1641625786991725,"guid":"1e6cf71e-632e-4b0e-bbf8-5d31d5bfaae3","subtype":"command","commandType":"auto","position":59.0,"command":"%md\n### (3f) Handling unseen features\n\nWe naturally would like to repeat the process from Part (3e), to compute OHE features for the validation and test datasets.  However, we must be careful, as some categorical values will likely appear in new data that did not exist in the training data. To deal with this situation, update the `one_hot_encoding()` function from Part (1d) to ignore previously unseen categories, and then compute OHE features for the validation data.  Remember that you can parse a raw DataFrame using `parse_raw_df`.\n> Note: you'll have to generate a new UDF using `ohe_udf_generator` so that the updated `one_hot_encoding` function is used.  And make sure to cache `ohe_validation_df`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296389E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e82f65bc-67e4-4b4e-a935-bcc2cbda7810"},{"version":"CommandV1","origId":1641625786991726,"guid":"436219cc-5dda-4561-9b69-dd9f98874406","subtype":"command","commandType":"auto","position":60.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef one_hot_encoding(raw_feats, ohe_dict_broadcast, num_ohe_feats):\n    \"\"\"Produce a one-hot-encoding from a list of features and an OHE dictionary.\n\n    Note:\n        You should ensure that the indices used to create a SparseVector are sorted, and that the\n        function handles missing features.\n\n    Args:\n        raw_feats (list of (int, str)): The features corresponding to a single observation.  Each\n            feature consists of a tuple of featureID and the feature's value. (e.g. sample_one)\n        ohe_dict_broadcast (Broadcast of dict): Broadcast variable containing a dict that maps\n            (featureID, value) to unique integer.\n        num_ohe_feats (int): The total number of unique OHE features (combinations of featureID and\n            value).\n\n    Returns:\n        SparseVector: A SparseVector of length num_ohe_feats with indices equal to the unique\n            identifiers for the (featureID, value) combinations that occur in the observation and\n            with values equal to 1.0.\n    \"\"\"\n    vec = []\n    \n    for i in raw_feats:\n      if i in ohe_dict_broadcast.value:\n        vec.append(ohe_dict_broadcast.value[i])\n\n    return SparseVector(num_ohe_feats,sorted(vec),np.ones(len(vec)))\n\nohe_dict_missing_udf = ohe_udf_generator(ohe_dict_broadcast)\nparsed_validation_df = parse_raw_df(raw_validation_df)\nohe_validation_df = parsed_validation_df.select('label',ohe_dict_missing_udf(parsed_validation_df.features).alias('features')).cache()\n\nohe_validation_df.count()\nohe_validation_df.show(1, truncate=False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|label|features                                                                                                                                                                                                                                                                                                                                                                                                                  |\n+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|0.0  |(233941,[0,1,11,39036,39037,39038,39039,39040,39041,39045,39046,39066,77792,77793,77794,77795,77796,77797,77798,98673,116844,116845,116846,116847,116849,116855,116856,155823,155824,155825,155826,155828,155830,155840,194837,194838,194839,194842,194846],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0])|\n+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 1 row\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747332199E12,"submitTime":1.469747296412E12,"finishTime":1.469747334414E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1505ce08-da5f-4c71-9d04-16a124b0f762"},{"version":"CommandV1","origId":1641625786991727,"guid":"cb1bdc4a-26e6-49ad-9635-edace070b5ef","subtype":"command","commandType":"auto","position":61.0,"command":"# TEST Handling unseen features (3f)\nfrom pyspark.sql.functions import size, sum as sqlsum\n\nTest.assertTrue(ohe_validation_df.is_cached, 'you need to cache ohe_validation_df')\nnum_nz_val = (ohe_validation_df\n                .select(sqlsum(size(get_indices('features'))))\n                .first()[0])\n\nnz_expected = 365226\nTest.assertEquals(num_nz_val, nz_expected, 'incorrect number of features: Got {0}, expected {1}'.format(num_nz_val, nz_expected))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747334417E12,"submitTime":1.469747296424E12,"finishTime":1.469747335391E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"33579caf-bd2e-4903-8fa7-f742b612598d"},{"version":"CommandV1","origId":1641625786991728,"guid":"9c24ccc9-0f88-420a-804c-7d5fd7d760f2","subtype":"command","commandType":"auto","position":62.0,"command":"%md\n## Part 4: CTR prediction and logloss evaluation","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296435E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1f21fec6-1be7-45c9-a15d-4a19284d72a0"},{"version":"CommandV1","origId":1641625786991729,"guid":"f20659fa-c410-425d-9f46-a35b0b974a07","subtype":"command","commandType":"auto","position":63.0,"command":"%md\n### (4a) Logistic regression\n\nWe are now ready to train our first CTR classifier.  A natural classifier to use in this setting is logistic regression, since it models the probability of a click-through event rather than returning a binary response, and when working with rare events, probabilistic predictions are useful.\n\nFirst use [LogisticRegression](https://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.classification.LogisticRegression) from the pyspark.ml package to train a model using `ohe_train_df` with the given hyperparameter configuration.  `LogisticRegression.fit` returns a [LogisticRegressionModel](https://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.classification.LogisticRegressionModel).  Next, we'll use the `LogisticRegressionModel.coefficients` and `LogisticRegressionModel.intercept` attributes to print out some details of the model's parameters.  Note that these are the names of the object's attributes and should be called using a syntax like `model.coefficients` for a given `model`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296453E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fa8bae33-0453-459c-9ed2-7fac08c6a964"},{"version":"CommandV1","origId":1781929634056976,"guid":"50a29885-22b9-44e3-846d-6d5b6111849f","subtype":"command","commandType":"auto","position":63.5,"command":"from pyspark.ml.classification import LogisticRegression\nhelp(LogisticRegression)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Help on class LogisticRegression in module pyspark.ml.classification:\n\nclass LogisticRegression(pyspark.ml.wrapper.JavaEstimator, pyspark.ml.param.shared.HasFeaturesCol, pyspark.ml.param.shared.HasLabelCol, pyspark.ml.param.shared.HasPredictionCol, pyspark.ml.param.shared.HasMaxIter, pyspark.ml.param.shared.HasRegParam, pyspark.ml.param.shared.HasTol, pyspark.ml.param.shared.HasProbabilityCol, pyspark.ml.param.shared.HasRawPredictionCol, pyspark.ml.param.shared.HasElasticNetParam, pyspark.ml.param.shared.HasFitIntercept, pyspark.ml.param.shared.HasStandardization, pyspark.ml.param.shared.HasThresholds, pyspark.ml.param.shared.HasWeightCol)\n |  Logistic regression.\n |  Currently, this class only supports binary classification.\n |  \n |  &gt;&gt;&gt; from pyspark.sql import Row\n |  &gt;&gt;&gt; from pyspark.mllib.linalg import Vectors\n |  &gt;&gt;&gt; df = sc.parallelize([\n |  ...     Row(label=1.0, weight=2.0, features=Vectors.dense(1.0)),\n |  ...     Row(label=0.0, weight=2.0, features=Vectors.sparse(1, [], []))]).toDF()\n |  &gt;&gt;&gt; lr = LogisticRegression(maxIter=5, regParam=0.01, weightCol=&quot;weight&quot;)\n |  &gt;&gt;&gt; model = lr.fit(df)\n |  &gt;&gt;&gt; model.coefficients\n |  DenseVector([5.5...])\n |  &gt;&gt;&gt; model.intercept\n |  -2.68...\n |  &gt;&gt;&gt; test0 = sc.parallelize([Row(features=Vectors.dense(-1.0))]).toDF()\n |  &gt;&gt;&gt; result = model.transform(test0).head()\n |  &gt;&gt;&gt; result.prediction\n |  0.0\n |  &gt;&gt;&gt; result.probability\n |  DenseVector([0.99..., 0.00...])\n |  &gt;&gt;&gt; result.rawPrediction\n |  DenseVector([8.22..., -8.22...])\n |  &gt;&gt;&gt; test1 = sc.parallelize([Row(features=Vectors.sparse(1, [0], [1.0]))]).toDF()\n |  &gt;&gt;&gt; model.transform(test1).head().prediction\n |  1.0\n |  &gt;&gt;&gt; lr.setParams(&quot;vector&quot;)\n |  Traceback (most recent call last):\n |      ...\n |  TypeError: Method setParams forces keyword arguments.\n |  \n |  .. versionadded:: 1.3.0\n |  \n |  Method resolution order:\n |      LogisticRegression\n |      pyspark.ml.wrapper.JavaEstimator\n |      pyspark.ml.pipeline.Estimator\n |      pyspark.ml.wrapper.JavaWrapper\n |      pyspark.ml.param.shared.HasFeaturesCol\n |      pyspark.ml.param.shared.HasLabelCol\n |      pyspark.ml.param.shared.HasPredictionCol\n |      pyspark.ml.param.shared.HasMaxIter\n |      pyspark.ml.param.shared.HasRegParam\n |      pyspark.ml.param.shared.HasTol\n |      pyspark.ml.param.shared.HasProbabilityCol\n |      pyspark.ml.param.shared.HasRawPredictionCol\n |      pyspark.ml.param.shared.HasElasticNetParam\n |      pyspark.ml.param.shared.HasFitIntercept\n |      pyspark.ml.param.shared.HasStandardization\n |      pyspark.ml.param.shared.HasThresholds\n |      pyspark.ml.param.shared.HasWeightCol\n |      pyspark.ml.param.Params\n |      pyspark.ml.util.Identifiable\n |      __builtin__.object\n |  \n |  Methods defined here:\n |  \n |  __init__(*args, **kwargs)\n |      __init__(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;,                  maxIter=100, regParam=0.1, elasticNetParam=0.0, tol=1e-6, fitIntercept=True,                  threshold=0.5, thresholds=None, probabilityCol=&quot;probability&quot;,                  rawPredictionCol=&quot;rawPrediction&quot;, standardization=True, weightCol=None)\n |      If the threshold and thresholds Params are both set, they must be equivalent.\n |  \n |  getThreshold(self)\n |      Gets the value of threshold or its default value.\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  getThresholds(self)\n |      If :py:attr:&#96;thresholds&#96; is set, return its value.\n |      Otherwise, if :py:attr:&#96;threshold&#96; is set, return the equivalent thresholds for binary\n |      classification: (1-threshold, threshold).\n |      If neither are set, throw an error.\n |      \n |      .. versionadded:: 1.5.0\n |  \n |  setParams(*args, **kwargs)\n |      setParams(self, featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;,                   maxIter=100, regParam=0.1, elasticNetParam=0.0, tol=1e-6, fitIntercept=True,                   threshold=0.5, thresholds=None, probabilityCol=&quot;probability&quot;,                   rawPredictionCol=&quot;rawPrediction&quot;, standardization=True, weightCol=None)\n |      Sets params for logistic regression.\n |      If the threshold and thresholds Params are both set, they must be equivalent.\n |      \n |      .. versionadded:: 1.3.0\n |  \n |  setThreshold(self, value)\n |      Sets the value of :py:attr:&#96;threshold&#96;.\n |      Clears value of :py:attr:&#96;thresholds&#96; if it has been set.\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  setThresholds(self, value)\n |      Sets the value of :py:attr:&#96;thresholds&#96;.\n |      Clears value of :py:attr:&#96;threshold&#96; if it has been set.\n |      \n |      .. versionadded:: 1.5.0\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes defined here:\n |  \n |  __abstractmethods__ = frozenset([])\n |  \n |  threshold = Param(parent=&apos;undefined&apos;, name=&apos;threshold&apos;, doc=...d and t...\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.wrapper.JavaEstimator:\n |  \n |  __metaclass__ = &lt;class &apos;abc.ABCMeta&apos;&gt;\n |      Metaclass for defining Abstract Base Classes (ABCs).\n |      \n |      Use this metaclass to create an ABC.  An ABC can be subclassed\n |      directly, and then acts as a mix-in class.  You can also register\n |      unrelated concrete classes (even built-in classes) and unrelated\n |      ABCs as &apos;virtual subclasses&apos; -- these and their descendants will\n |      be considered subclasses of the registering ABC by the built-in\n |      issubclass() function, but the registering ABC won&apos;t show up in\n |      their MRO (Method Resolution Order) nor will method\n |      implementations defined by the registering ABC be callable (not\n |      even via super()).\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.pipeline.Estimator:\n |  \n |  fit(self, dataset, params=None)\n |      Fits a model to the input dataset with optional parameters.\n |      \n |      :param dataset: input dataset, which is an instance of\n |                      :py:class:&#96;pyspark.sql.DataFrame&#96;\n |      :param params: an optional param map that overrides embedded\n |                     params. If a list/tuple of param maps is given,\n |                     this calls fit on each param map and returns a\n |                     list of models.\n |      :returns: fitted model(s)\n |      \n |      .. versionadded:: 1.3.0\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasFeaturesCol:\n |  \n |  getFeaturesCol(self)\n |      Gets the value of featuresCol or its default value.\n |  \n |  setFeaturesCol(self, value)\n |      Sets the value of :py:attr:&#96;featuresCol&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasFeaturesCol:\n |  \n |  featuresCol = Param(parent=&apos;undefined&apos;, name=&apos;featuresCol&apos;, doc=&apos;featu...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasLabelCol:\n |  \n |  getLabelCol(self)\n |      Gets the value of labelCol or its default value.\n |  \n |  setLabelCol(self, value)\n |      Sets the value of :py:attr:&#96;labelCol&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasLabelCol:\n |  \n |  labelCol = Param(parent=&apos;undefined&apos;, name=&apos;labelCol&apos;, doc=&apos;label colum...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasPredictionCol:\n |  \n |  getPredictionCol(self)\n |      Gets the value of predictionCol or its default value.\n |  \n |  setPredictionCol(self, value)\n |      Sets the value of :py:attr:&#96;predictionCol&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasPredictionCol:\n |  \n |  predictionCol = Param(parent=&apos;undefined&apos;, name=&apos;predictionCol&apos;, doc=&apos;p...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasMaxIter:\n |  \n |  getMaxIter(self)\n |      Gets the value of maxIter or its default value.\n |  \n |  setMaxIter(self, value)\n |      Sets the value of :py:attr:&#96;maxIter&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasMaxIter:\n |  \n |  maxIter = Param(parent=&apos;undefined&apos;, name=&apos;maxIter&apos;, doc=&apos;max number of...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasRegParam:\n |  \n |  getRegParam(self)\n |      Gets the value of regParam or its default value.\n |  \n |  setRegParam(self, value)\n |      Sets the value of :py:attr:&#96;regParam&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasRegParam:\n |  \n |  regParam = Param(parent=&apos;undefined&apos;, name=&apos;regParam&apos;, doc=&apos;regularizat...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasTol:\n |  \n |  getTol(self)\n |      Gets the value of tol or its default value.\n |  \n |  setTol(self, value)\n |      Sets the value of :py:attr:&#96;tol&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasTol:\n |  \n |  tol = Param(parent=&apos;undefined&apos;, name=&apos;tol&apos;, doc=&apos;the convergence toler...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasProbabilityCol:\n |  \n |  getProbabilityCol(self)\n |      Gets the value of probabilityCol or its default value.\n |  \n |  setProbabilityCol(self, value)\n |      Sets the value of :py:attr:&#96;probabilityCol&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasProbabilityCol:\n |  \n |  probabilityCol = Param(parent=&apos;undefined&apos;, name=&apos;probabilityCol&apos;,...at...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasRawPredictionCol:\n |  \n |  getRawPredictionCol(self)\n |      Gets the value of rawPredictionCol or its default value.\n |  \n |  setRawPredictionCol(self, value)\n |      Sets the value of :py:attr:&#96;rawPredictionCol&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasRawPredictionCol:\n |  \n |  rawPredictionCol = Param(parent=&apos;undefined&apos;, name=&apos;rawPredictionCol......\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasElasticNetParam:\n |  \n |  getElasticNetParam(self)\n |      Gets the value of elasticNetParam or its default value.\n |  \n |  setElasticNetParam(self, value)\n |      Sets the value of :py:attr:&#96;elasticNetParam&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasElasticNetParam:\n |  \n |  elasticNetParam = Param(parent=&apos;undefined&apos;, name=&apos;elasticNetParam&apos;...L...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasFitIntercept:\n |  \n |  getFitIntercept(self)\n |      Gets the value of fitIntercept or its default value.\n |  \n |  setFitIntercept(self, value)\n |      Sets the value of :py:attr:&#96;fitIntercept&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasFitIntercept:\n |  \n |  fitIntercept = Param(parent=&apos;undefined&apos;, name=&apos;fitIntercept&apos;, doc=&apos;whe...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasStandardization:\n |  \n |  getStandardization(self)\n |      Gets the value of standardization or its default value.\n |  \n |  setStandardization(self, value)\n |      Sets the value of :py:attr:&#96;standardization&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasStandardization:\n |  \n |  standardization = Param(parent=&apos;undefined&apos;, name=&apos;standardization&apos;...t...\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasThresholds:\n |  \n |  thresholds = Param(parent=&apos;undefined&apos;, name=&apos;thresholds&apos;, doc...ty of ...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.shared.HasWeightCol:\n |  \n |  getWeightCol(self)\n |      Gets the value of weightCol or its default value.\n |  \n |  setWeightCol(self, value)\n |      Sets the value of :py:attr:&#96;weightCol&#96;.\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes inherited from pyspark.ml.param.shared.HasWeightCol:\n |  \n |  weightCol = Param(parent=&apos;undefined&apos;, name=&apos;weightCol&apos;, doc=...or empt...\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.param.Params:\n |  \n |  copy(self, extra=None)\n |      Creates a copy of this instance with the same uid and some\n |      extra params. The default implementation creates a\n |      shallow copy using :py:func:&#96;copy.copy&#96;, and then copies the\n |      embedded and extra parameters over and returns the copy.\n |      Subclasses should override this method if the default approach\n |      is not sufficient.\n |      \n |      :param extra: Extra parameters to copy to the new instance\n |      :return: Copy of this instance\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  explainParam(self, param)\n |      Explains a single param and returns its name, doc, and optional\n |      default value and user-supplied value in a string.\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  explainParams(self)\n |      Returns the documentation of all params with their optionally\n |      default values and user-supplied values.\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  extractParamMap(self, extra=None)\n |      Extracts the embedded default param values and user-supplied\n |      values, and then merges them with extra values from input into\n |      a flat param map, where the latter value is used if there exist\n |      conflicts, i.e., with ordering: default param values &lt;\n |      user-supplied values &lt; extra.\n |      \n |      :param extra: extra param values\n |      :return: merged param map\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  getOrDefault(self, param)\n |      Gets the value of a param in the user-supplied param map or its\n |      default value. Raises an error if neither is set.\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  getParam(self, paramName)\n |      Gets a param by its name.\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  hasDefault(self, param)\n |      Checks whether a param has a default value.\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  hasParam(self, paramName)\n |      Tests whether this instance contains a param with a given\n |      (string) name.\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  isDefined(self, param)\n |      Checks whether a param is explicitly set by user or has\n |      a default value.\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  isSet(self, param)\n |      Checks whether a param is explicitly set by user.\n |      \n |      .. versionadded:: 1.4.0\n |  \n |  ----------------------------------------------------------------------\n |  Data descriptors inherited from pyspark.ml.param.Params:\n |  \n |  params\n |      Returns all params ordered by name. The default implementation\n |      uses :py:func:&#96;dir&#96; to get all attributes of type\n |      :py:class:&#96;Param&#96;.\n |      \n |      .. versionadded:: 1.3.0\n |  \n |  ----------------------------------------------------------------------\n |  Methods inherited from pyspark.ml.util.Identifiable:\n |  \n |  __repr__(self)\n |  \n |  ----------------------------------------------------------------------\n |  Data descriptors inherited from pyspark.ml.util.Identifiable:\n |  \n |  __dict__\n |      dictionary for instance variables (if defined)\n |  \n |  __weakref__\n |      list of weak references to the object (if defined)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747335394E12,"submitTime":1.469747296475E12,"finishTime":1.469747335465E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ba7152e8-0929-4445-8014-e8fc57a7d2bd"},{"version":"CommandV1","origId":1641625786991730,"guid":"60c200b2-49e5-42a8-8a57-12cfa5117e46","subtype":"command","commandType":"auto","position":64.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nstandardization = False\nelastic_net_param = 0.0\nreg_param = .01\nmax_iter = 20\n\nfrom pyspark.ml.classification import LogisticRegression\nlr = LogisticRegression(featuresCol=\"features\", labelCol=\"label\", maxIter=max_iter, regParam=0.01, elasticNetParam=elastic_net_param,rawPredictionCol=\"rawPrediction\", standardization=False)\n\nlr_model_basic = lr.fit(ohe_train_df)\n\nprint 'intercept: {0}'.format(lr_model_basic.intercept)\nprint 'length of coefficients: {0}'.format(len(lr_model_basic.coefficients))\nsorted_coefficients = sorted(lr_model_basic.coefficients)[:5]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">intercept: -1.23057928975\nlength of coefficients: 233941\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747335468E12,"submitTime":1.469747296487E12,"finishTime":1.469747348313E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"dd76c563-0c1a-4e3c-aa7b-9ff45cf404f8"},{"version":"CommandV1","origId":1641625786991731,"guid":"f16363f2-e611-4500-80ab-2b83b1f816b5","subtype":"command","commandType":"auto","position":65.0,"command":"# TEST Logistic regression (4a)\nTest.assertTrue(np.allclose(lr_model_basic.intercept,  -1.23057928975), 'incorrect value for model intercept')\nTest.assertTrue(np.allclose(sorted_coefficients,\n                           [-0.1187459897152528, -0.10978507583227733, -0.10927080243659906, -0.10854213952664242, -0.10715533859341671]),\n                           'incorrect value for model coefficients')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747348316E12,"submitTime":1.469747296498E12,"finishTime":1.469747348339E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6f07a898-dea4-424c-8d54-3b3e0ecc037d"},{"version":"CommandV1","origId":1641625786991732,"guid":"366540c3-a1cd-4c94-a7d9-ef8992b51527","subtype":"command","commandType":"auto","position":66.0,"command":"%md\n### (4b) Log loss\nThroughout this lab, we will use log loss to evaluate the quality of models.  Log loss is defined as: \\\\[ \\scriptsize \\ell_{log}(p, y) = \\begin{cases} -\\log (p) & \\text{if } y = 1 \\\\\\ -\\log(1-p) & \\text{if } y = 0 \\end{cases} \\\\] where \\\\( \\scriptsize p\\\\) is a probability between 0 and 1 and \\\\( \\scriptsize y\\\\) is a label of either 0 or 1. Log loss is a standard evaluation criterion when predicting rare-events such as click-through rate prediction (it is also the criterion used in the [Criteo Kaggle competition](https://www.kaggle.com/c/criteo-display-ad-challenge)).\n\nWrite a function `add_log_loss` to a DataFrame, and evaluate it on some sample inputs.  This does not require a UDF.  You can perform conditional branching with DataFrame columns using [when](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.when).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296508E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9f113fea-ce90-4dea-b625-bd11ea849932"},{"version":"CommandV1","origId":1641625786991733,"guid":"2a9c0691-fd15-455e-ac8f-9965997098ec","subtype":"command","commandType":"auto","position":67.0,"command":"# Some example data\nexample_log_loss_df = sqlContext.createDataFrame([(.5, 1), (.5, 0), (.99, 1), (.99, 0), (.01, 1),\n                                                  (.01, 0), (1., 1), (.0, 1), (1., 0)], ['p', 'label'])\nexample_log_loss_df.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+-----+\n|   p|label|\n+----+-----+\n| 0.5|    1|\n| 0.5|    0|\n|0.99|    1|\n|0.99|    0|\n|0.01|    1|\n|0.01|    0|\n| 1.0|    1|\n| 0.0|    1|\n| 1.0|    0|\n+----+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747348341E12,"submitTime":1.46974729653E12,"finishTime":1.469747348513E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"db543f97-d7ea-4168-ad71-e5a0fc6b37b6"},{"version":"CommandV1","origId":1641625786991734,"guid":"03c0469a-6ccd-4b86-a129-f4bd1e5dda7a","subtype":"command","commandType":"auto","position":68.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nfrom pyspark.sql.functions import when, log, col\nepsilon = 1e-16\n\ndef add_log_loss(df):\n    \"\"\"Computes and adds a 'log_loss' column to a DataFrame using 'p' and 'label' columns.\n\n    Note:\n        log(0) is undefined, so when p is 0 we add a small value (epsilon) to it and when\n        p is 1 we subtract a small value (epsilon) from it.\n\n    Args:\n        df (DataFrame with 'p' and 'label' columns): A DataFrame with a probability column\n            'p' and a 'label' column that corresponds to y in the log loss formula.\n\n    Returns:\n        DataFrame: A new DataFrame with an additional column called 'log_loss' where 'log_loss' column contains the loss value as explained above.\n    \"\"\"\n    #df.show(1)\n    data = df.select(when(df.label==0, -1*log(1-df.p+epsilon)).otherwise(-1*log(df.p+epsilon)).alias('log_loss'),'p','label')\n    return data\n\nadd_log_loss(example_log_loss_df).show(1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------+---+-----+\n|          log_loss|  p|label|\n+------------------+---+-----+\n|0.6931471805599451|0.5|    1|\n+------------------+---+-----+\nonly showing top 1 row\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747348515E12,"submitTime":1.469747296541E12,"finishTime":1.469747348687E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e553c23a-aa80-41cd-a7af-0914e11355ea"},{"version":"CommandV1","origId":1641625786991735,"guid":"f11062a3-fd43-44ee-8eb8-c6b2b4f8f26e","subtype":"command","commandType":"auto","position":69.0,"command":"# TEST Log loss (4b)\nlog_loss_values = add_log_loss(example_log_loss_df).select('log_loss').rdd.map(lambda r: r[0]).collect()\nTest.assertTrue(np.allclose(log_loss_values[:-2],\n                            [0.6931471805599451, 0.6931471805599451, 0.010050335853501338, 4.60517018598808,\n                             4.605170185988081, 0.010050335853501338, -0.0]), 'log loss is not correct')\nTest.assertTrue(not(any(map(lambda x: x is None, log_loss_values[-2:]))),\n                'log loss needs to bound p away from 0 and 1 by epsilon')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46974734869E12,"submitTime":1.469747296552E12,"finishTime":1.469747348911E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"177d23c0-6b23-4d06-bc65-a83622819e9a"},{"version":"CommandV1","origId":1641625786991736,"guid":"ed423576-b59a-4a28-9114-1636cfd122e7","subtype":"command","commandType":"auto","position":70.0,"command":"%md\n### (4c)  Baseline log loss\n\nNext we will use the function we wrote in Part (4b) to compute the baseline log loss on the training data. A very simple yet natural baseline model is one where we always make the same prediction independent of the given datapoint, setting the predicted value equal to the fraction of training points that correspond to click-through events (i.e., where the label is one). Compute this value (which is simply the mean of the training labels), and then use it to compute the training log loss for the baseline model.\n\n> Note: you'll need to add a `p` column to the `ohe_train_df` DataFrame so that it can be used in your function from Part (4b).  To represent a constant value as a column you can use the [lit](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.lit) function to wrap the value.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296563E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"749c04a1-4ebb-4be4-9b6b-4e967c44f764"},{"version":"CommandV1","origId":1641625786991737,"guid":"6ea1a7e7-06d7-4fe0-8adb-296ae892f0c4","subtype":"command","commandType":"auto","position":71.0,"command":"# TODO: Replace <FILL IN> with appropriate code\n# Note that our dataset has a very high click-through rate by design\n# In practice click-through rate can be one to two orders of magnitude lower\n\nfrom pyspark.sql.functions import lit\nclass_one_frac_train = (ohe_train_df.selectExpr(\"avg(label)\")).collect()[0][0]\nmean = class_one_frac_train\nprint 'Training class one fraction = {0:.3f}'.format(class_one_frac_train)\n\nlog_loss_tr_base = add_log_loss(ohe_train_df.select('label',lit(mean).alias('p'))).selectExpr(\"avg(log_loss)\").collect()[0][0]\nprint 'Baseline Train Logloss = {0:.3f}\\n'.format(log_loss_tr_base)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Training class one fraction = 0.226\nBaseline Train Logloss = 0.535\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747348914E12,"submitTime":1.469747296584E12,"finishTime":1.469747349135E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"45eda6db-557e-41bb-a96c-70da5364b985"},{"version":"CommandV1","origId":1641625786991738,"guid":"1e0d0fee-eabf-470c-868c-1f10c0284d69","subtype":"command","commandType":"auto","position":72.0,"command":"# TEST Baseline log loss (4c)\nexpected_frac = 0.226209184564\nexpected_log_loss = 0.53465512785\nTest.assertTrue(np.allclose(class_one_frac_train, expected_frac), 'incorrect value for class_one_frac_train. Got {0}, expected {1}'.format(class_one_frac_train, expected_frac))\nTest.assertTrue(np.allclose(log_loss_tr_base, expected_log_loss), 'incorrect value for log_loss_tr_base. Got {0}, expected {1}'.format(log_loss_tr_base, expected_log_loss))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747349138E12,"submitTime":1.469747296595E12,"finishTime":1.469747349209E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"09fa528d-400a-4cef-8c42-b460a046e8b5"},{"version":"CommandV1","origId":1641625786991739,"guid":"bcdfeb38-83e9-4337-9c69-37cbe289cb4b","subtype":"command","commandType":"auto","position":73.0,"command":"%md\n### (4d) Predicted probability\n\nIn order to compute the log loss for the model we trained in Part (4a), we need to write code to generate predictions from this model. Write a function that computes the raw linear prediction from this logistic regression model and then passes it through a [sigmoid function](http://en.wikipedia.org/wiki/Sigmoid_function) \\\\( \\scriptsize \\sigma(t) = (1+ e^{-t})^{-1} \\\\) to return the model's probabilistic prediction. Then compute probabilistic predictions on the training data.\n\nNote that when incorporating an intercept into our predictions, we simply add the intercept to the value of the prediction obtained from the weights and features.  Alternatively, if the intercept was included as the first weight, we would need to add a corresponding feature to our data where the feature has the value one.  This is not the case here.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296607E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"cadd4eb7-202f-4720-96b9-db83c9d6ab2e"},{"version":"CommandV1","origId":1641625786991740,"guid":"332dec40-1eb5-4df4-b7b9-9d86720b05f8","subtype":"command","commandType":"auto","position":74.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nfrom pyspark.sql.types import DoubleType\nfrom math import exp #  exp(-t) = e^-t\n\ndef add_probability(df, model):\n    \"\"\"Adds a probability column ('p') to a DataFrame given a model\"\"\"\n    coefficients_broadcast = sc.broadcast(model.coefficients)\n    intercept = model.intercept\n\n    def get_p(features):\n        \"\"\"Calculate the probability for an observation given a list of features.\n\n        Note:\n            We'll bound our raw prediction between 20 and -20 for numerical purposes.\n\n        Args:\n            features: the features\n\n        Returns:\n            float: A probability between 0 and 1.\n        \"\"\"\n        # Compute the raw value\n        raw_prediction = features.dot(coefficients_broadcast.value) + intercept\n        # Bound the raw value between 20 and -20\n        raw_prediction = max(-20,min(20,raw_prediction))\n        # Return the probability\n        return pow((1+exp(-1*raw_prediction)),-1)\n\n    get_p_udf = udf(get_p, DoubleType())\n    return df.withColumn('p', get_p_udf('features'))\n\nadd_probability_model_basic = lambda df: add_probability(df, lr_model_basic)\ntraining_predictions = add_probability_model_basic(ohe_train_df).cache()\n\ntraining_predictions.show(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+--------------------+-------------------+\n|label|            features|                  p|\n+-----+--------------------+-------------------+\n|  0.0|(233941,[0,1,3903...| 0.1524569011902128|\n|  0.0|(233941,[2,3,4,39...|0.15116321092690524|\n|  0.0|(233941,[5,6,3903...|0.16569053420524252|\n|  0.0|(233941,[7,8,9,39...|0.12978985339524937|\n|  0.0|(233941,[6,39036,...| 0.1909081707983523|\n+-----+--------------------+-------------------+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.469747349211E12,"submitTime":1.469747296625E12,"finishTime":1.469747357854E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"67ad7870-0273-4d09-8355-0cc074cc677b"},{"version":"CommandV1","origId":1641625786991741,"guid":"32147171-4a37-4260-b0e7-7c8706a1d450","subtype":"command","commandType":"auto","position":75.0,"command":"# TEST Predicted probability (4d)\nexpected = 18168.793778\ngot = training_predictions.selectExpr('sum(p)').first()[0]\nTest.assertTrue(np.allclose(got, expected),\n                'incorrect value for training_predictions. Got {0}, expected {1}'.format(got, expected))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747357856E12,"submitTime":1.469747296637E12,"finishTime":1.469747363884E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ad47b345-2186-4620-9bfd-82b363e6055e"},{"version":"CommandV1","origId":1641625786991742,"guid":"06384ea4-6f08-4514-83b3-9fe255a537d5","subtype":"command","commandType":"auto","position":76.0,"command":"%md\n### (4e) Evaluate the model\n\nWe are now ready to evaluate the quality of the model we trained in Part (4a). To do this, first write a general function that takes as input a model and data, and outputs the log loss. Note that the log loss for multiple observations is the mean of the individual log loss values. Then run this function on the OHE training data, and compare the result with the baseline log loss.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296647E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"65c3c153-0e2d-4f43-8b5a-70be65a7906c"},{"version":"CommandV1","origId":1641625786991743,"guid":"3e0c5031-c7f2-4a73-9c3e-d4d640b37a51","subtype":"command","commandType":"auto","position":77.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef evaluate_results(df, model, baseline=None):\n    \"\"\"Calculates the log loss for the data given the model.\n\n    Note:\n        If baseline has a value the probability should be set to baseline before\n        the log loss is calculated.  Otherwise, use add_probability to add the\n        appropriate probabilities to the DataFrame.\n\n    Args:\n        df (DataFrame with 'label' and 'features' columns): A DataFrame containing\n            labels and features.\n        model (LogisticRegressionModel): A trained logistic regression model. This\n            can be None if baseline is set.\n        baseline (float): A baseline probability to use for the log loss calculation.\n\n    Returns:\n        float: Log loss for the data.\n    \"\"\"\n    if baseline:\n      temp_data = df.withColumn('p',lit(baseline))\n      with_log_loss_df = add_log_loss(temp_data)\n    else:\n      with_probability_df = add_probability(df, model)\n      with_log_loss_df = add_log_loss(with_probability_df)\n    log_loss = with_log_loss_df.selectExpr(\"avg(log_loss)\").first()[0]\n    return log_loss\n\nlog_loss_train_model_basic = evaluate_results(ohe_train_df, lr_model_basic)\nprint ('OHE Features Train Logloss:\\n\\tBaseline = {0:.3f}\\n\\tLogReg = {1:.3f}'\n       .format(log_loss_tr_base, log_loss_train_model_basic))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">OHE Features Train Logloss:\n\tBaseline = 0.535\n\tLogReg = 0.475\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747363886E12,"submitTime":1.469747296666E12,"finishTime":1.469747372447E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5bf468e7-8ca5-4bd9-ac82-370fc9de09fa"},{"version":"CommandV1","origId":1641625786991744,"guid":"26e70134-65e5-4b66-8802-7686536bb149","subtype":"command","commandType":"auto","position":78.0,"command":"# TEST Evaluate the model (4e)\nexpected_log_loss = 0.474685722542\nTest.assertTrue(np.allclose(log_loss_train_model_basic, expected_log_loss),\n                'incorrect value for log_loss_train_model_basic. Got {0}, expected {1}'.format(log_loss_train_model_basic, expected_log_loss))\nexpected_res = 0.6931471805600546\nres = evaluate_results(ohe_train_df, None,  0.5)\nTest.assertTrue(np.allclose(res, expected_res),\n                'evaluate_results needs to handle baseline models. Got {0}, expected {1}'.format(res, expected_res))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46974737245E12,"submitTime":1.469747296677E12,"finishTime":1.469747372622E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0a8b71f1-27b0-47d5-b2bb-5f95249fe60e"},{"version":"CommandV1","origId":1641625786991745,"guid":"af6f192e-2c08-4587-aeef-4f9d45437acb","subtype":"command","commandType":"auto","position":79.0,"command":"%md\n### (4f) Validation log loss\n\nNext, using the `evaluate_results` function compute the validation log loss for both the baseline and logistic regression models. Notably, the baseline model for the validation data should still be based on the label fraction from the training dataset.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296687E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"07fe261c-6fe8-46c7-9634-0d9689dedd81"},{"version":"CommandV1","origId":1641625786991746,"guid":"e8299e3a-570b-4388-959c-6b052a88fcc4","subtype":"command","commandType":"auto","position":80.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nlog_loss_val_base = evaluate_results(ohe_validation_df,None,class_one_frac_train)\n\nlog_loss_val_l_r0 = evaluate_results(ohe_validation_df, lr_model_basic, None)\n\nprint ('OHE Features Validation Logloss:\\n\\tBaseline = {0:.3f}\\n\\tLogReg = {1:.3f}'\n       .format(log_loss_val_base, log_loss_val_l_r0))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">OHE Features Validation Logloss:\n\tBaseline = 0.544\n\tLogReg = 0.488\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747372625E12,"submitTime":1.469747296703E12,"finishTime":1.469747375995E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"62c1bd12-f734-4fd6-9f70-273f33568bae"},{"version":"CommandV1","origId":1641625786991747,"guid":"2c6738a5-dfb1-498a-8672-f8078d532b57","subtype":"command","commandType":"auto","position":81.0,"command":"# TEST Validation log loss (4f)\nexpected_val_base = 0.544167185783\nTest.assertTrue(np.allclose(log_loss_val_base, expected_val_base),\n                'incorrect value for log_loss_val_base. Got {0}, expected {1}'.format(log_loss_val_base, expected_val_base))\nexpected_val_model_basic = 0.487967958915\nTest.assertTrue(np.allclose(log_loss_val_l_r0, expected_val_model_basic),\n                'incorrect value for log_loss_val_l_r0. Got {0}, expected {1}'.format(log_loss_val_l_r0, expected_val_model_basic))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747375997E12,"submitTime":1.469747296713E12,"finishTime":1.469747376068E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"51e31502-f306-482d-a8b9-06089522f323"},{"version":"CommandV1","origId":1641625786991748,"guid":"af36b711-c384-4a14-a1a6-c7e108d7659b","subtype":"command","commandType":"auto","position":82.0,"command":"%md\n### Visualization 2: ROC curve\n\nWe will now visualize how well the model predicts our target.  To do this we generate a plot of the ROC curve.  The ROC curve shows us the trade-off between the false positive rate and true positive rate, as we liberalize the threshold required to predict a positive outcome.  A random model is represented by the dashed line.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296724E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"71aa69e9-de7d-47f4-a39d-fb0e9cf398b5"},{"version":"CommandV1","origId":1641625786991749,"guid":"a113e561-894d-44a1-988f-c8489abd9ad3","subtype":"command","commandType":"auto","position":83.0,"command":"labels_and_scores = add_probability_model_basic(ohe_validation_df).select('label', 'p')\nlabels_and_weights = labels_and_scores.collect()\nlabels_and_weights.sort(key=lambda (k, v): v, reverse=True)\nlabels_by_weight = np.array([k for (k, v) in labels_and_weights])\n\nlength = labels_by_weight.size\ntrue_positives = labels_by_weight.cumsum()\nnum_positive = true_positives[-1]\nfalse_positives = np.arange(1.0, length + 1, 1.) - true_positives\n\ntrue_positive_rate = true_positives / num_positive\nfalse_positive_rate = false_positives / (length - num_positive)\n\n# Generate layout and plot data\nfig, ax = prepare_plot(np.arange(0., 1.1, 0.1), np.arange(0., 1.1, 0.1))\nax.set_xlim(-.05, 1.05), ax.set_ylim(-.05, 1.05)\nax.set_ylabel('True Positive Rate (Sensitivity)')\nax.set_xlabel('False Positive Rate (1 - Specificity)')\nplt.plot(false_positive_rate, true_positive_rate, color='#8cbfd0', linestyle='-', linewidth=3.)\nplt.plot((0., 1.), (0., 1.), linestyle='--', color='#d6ebf2', linewidth=2.)  # Baseline model\ndisplay(fig)","commandVersion":0,"state":"finished","results":{"type":"image","data":"data:image/png;base64,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","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46974737607E12,"submitTime":1.469747296744E12,"finishTime":1.469747380024E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7556978e-880a-4be2-95c2-ccb095de57dd"},{"version":"CommandV1","origId":1641625786991750,"guid":"8cbbe1aa-f5e8-4382-97d6-d013d37d34e4","subtype":"command","commandType":"auto","position":84.0,"command":"%md\n## Part 5: Reduce feature dimension via feature hashing","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296754E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"65ed6a0c-314c-4e05-a133-1bd8ad0494f4"},{"version":"CommandV1","origId":1641625786991751,"guid":"c2a01357-3935-46cc-ac4a-85e7cedda666","subtype":"command","commandType":"auto","position":85.0,"command":"%md\n### (5a) Hash function\n\nAs we just saw, using a one-hot-encoding featurization can yield a model with good statistical accuracy.  However, the number of distinct categories across all features is quite large -- recall that we observed 233K categories in the training data in Part (3c).  Moreover, the full Kaggle training dataset includes more than 33M distinct categories, and the Kaggle dataset itself is just a small subset of Criteo's labeled data.  Hence, featurizing via a one-hot-encoding representation would lead to a very large feature vector. To reduce the dimensionality of the feature space, we will use feature hashing.\n\nBelow is the hash function that we will use for this part of the lab.  We will first use this hash function with the three sample data points from Part (1a) to gain some intuition.  Specifically, run code to hash the three sample points using two different values for `numBuckets` and observe the resulting hashed feature dictionaries.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296777E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d7a3134f-3fdf-4fb1-b639-68869a5adaf8"},{"version":"CommandV1","origId":1641625786991752,"guid":"f56360da-d78b-4ea5-85a3-59ce70f7b1e7","subtype":"command","commandType":"auto","position":86.0,"command":"from collections import defaultdict\nimport hashlib\n\ndef hash_function(raw_feats, num_buckets, print_mapping=False):\n    \"\"\"Calculate a feature dictionary for an observation's features based on hashing.\n\n    Note:\n        Use print_mapping=True for debug purposes and to better understand how the hashing works.\n\n    Args:\n        raw_feats (list of (int, str)): A list of features for an observation.  Represented as\n            (featureID, value) tuples.\n        num_buckets (int): Number of buckets to use as features.\n        print_mapping (bool, optional): If true, the mappings of featureString to index will be\n            printed.\n\n    Returns:\n        dict of int to float:  The keys will be integers which represent the buckets that the\n            features have been hashed to.  The value for a given key will contain the count of the\n            (featureID, value) tuples that have hashed to that key.\n    \"\"\"\n    mapping = { category + ':' + str(ind):\n                int(int(hashlib.md5(category + ':' + str(ind)).hexdigest(), 16) % num_buckets)\n                for ind, category in raw_feats}\n    if(print_mapping): print mapping\n\n    def map_update(l, r):\n        l[r] += 1.0\n        return l\n\n    sparse_features = reduce(map_update, mapping.values(), defaultdict(float))\n    return dict(sparse_features)\n\n# Reminder of the sample values:\n# sample_one = [(0, 'mouse'), (1, 'black')]\n# sample_two = [(0, 'cat'), (1, 'tabby'), (2, 'mouse')]\n# sample_three =  [(0, 'bear'), (1, 'black'), (2, 'salmon')]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747380027E12,"submitTime":1.469747296793E12,"finishTime":1.469747380062E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d010b5d8-63d2-4dfe-9dd4-adb132f8ddf7"},{"version":"CommandV1","origId":1641625786991753,"guid":"73776bf5-c85c-4ef9-b5f6-b02fc83a0c27","subtype":"command","commandType":"auto","position":87.0,"command":"# TODO: Replace <FILL IN> with appropriate code\n# Use four buckets\nsamp_one_four_buckets = hash_function(sample_one, 4, True)\nsamp_two_four_buckets = hash_function(sample_two, 4, True)\nsamp_three_four_buckets = hash_function(sample_three, 4, True)\n\n# Use one hundred buckets\nsamp_one_hundred_buckets = hash_function(sample_one, 100, True)\nsamp_two_hundred_buckets = hash_function(sample_two, 100, True)\nsamp_three_hundred_buckets = hash_function(sample_three, 100, True)\n\nprint '\\n\\t\\t 4 Buckets \\t\\t\\t 100 Buckets'\nprint 'SampleOne:\\t {0}\\t\\t\\t {1}'.format(samp_one_four_buckets, samp_one_hundred_buckets)\nprint 'SampleTwo:\\t {0}\\t\\t {1}'.format(samp_two_four_buckets, samp_two_hundred_buckets)\nprint 'SampleThree:\\t {0}\\t {1}'.format(samp_three_four_buckets, samp_three_hundred_buckets)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">{&apos;mouse:0&apos;: 3, &apos;black:1&apos;: 3}\n{&apos;mouse:2&apos;: 1, &apos;tabby:1&apos;: 0, &apos;cat:0&apos;: 1}\n{&apos;bear:0&apos;: 2, &apos;black:1&apos;: 3, &apos;salmon:2&apos;: 0}\n{&apos;mouse:0&apos;: 99, &apos;black:1&apos;: 51}\n{&apos;mouse:2&apos;: 9, &apos;tabby:1&apos;: 72, &apos;cat:0&apos;: 21}\n{&apos;bear:0&apos;: 82, &apos;black:1&apos;: 51, &apos;salmon:2&apos;: 80}\n\n\t\t 4 Buckets \t\t\t 100 Buckets\nSampleOne:\t {3: 2.0}\t\t\t {99: 1.0, 51: 1.0}\nSampleTwo:\t {0: 1.0, 1: 2.0}\t\t {72: 1.0, 9: 1.0, 21: 1.0}\nSampleThree:\t {0: 1.0, 2: 1.0, 3: 1.0}\t {80: 1.0, 82: 1.0, 51: 1.0}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747380064E12,"submitTime":1.469747296803E12,"finishTime":1.469747380103E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9e203958-a664-4ab4-8b7d-8c94afee49c4"},{"version":"CommandV1","origId":1641625786991754,"guid":"f38648c3-b498-428b-bc45-7d2226dc7eb4","subtype":"command","commandType":"auto","position":88.0,"command":"# TEST Hash function (5a)\nTest.assertEquals(samp_one_four_buckets, {3: 2.0}, 'incorrect value for samp_one_four_buckets')\nTest.assertEquals(samp_three_hundred_buckets, {80: 1.0, 82: 1.0, 51: 1.0},\n                  'incorrect value for samp_three_hundred_buckets')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747380104E12,"submitTime":1.469747296813E12,"finishTime":1.469747380142E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"72270745-68a7-4bfb-9f26-ddbc69a1134e"},{"version":"CommandV1","origId":1641625786991755,"guid":"1ac48c20-1a00-48d0-b0e5-4c3a6e93020e","subtype":"command","commandType":"auto","position":89.0,"command":"%md\n### (5b) Creating hashed features\n\nNext we will use this hash function to create hashed features for our CTR datasets. Use the provided UDF to create a function that takes in a DataFrame and returns labels and hashed features.  Then use this function to create new training, validation and test datasets with hashed features.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296826E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c091e76a-ef79-42ea-914a-ce603ffa6bdf"},{"version":"CommandV1","origId":1641625786991756,"guid":"20c38649-f9c1-4296-bcc9-8eb3f91f268c","subtype":"command","commandType":"auto","position":90.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nfrom pyspark.mllib.linalg import Vectors\nnum_hash_buckets = 2 ** 15\n\n# UDF that returns a vector of hashed features given an Array of tuples\ntuples_to_hash_features_udf = udf(lambda x: Vectors.sparse(num_hash_buckets, hash_function(x, num_hash_buckets)), VectorUDT())\n\ndef add_hashed_features(df):\n    \"\"\"Return a DataFrame with labels and hashed features.\n\n    Note:\n        Make sure to cache the DataFrame that you are returning.\n\n    Args:\n        df (DataFrame with 'tuples' column): A DataFrame containing the tuples to be hashed.\n\n    Returns:\n        DataFrame: A DataFrame with a 'label' column and a 'features' column that contains a\n            SparseVector of hashed features.\n    \"\"\"\n    return df.select('label',tuples_to_hash_features_udf('features').alias('features'))\n    \nhash_train_df = add_hashed_features(parsed_train_df)\nhash_validation_df = add_hashed_features(parsed_validation_df)\nhash_test_df = add_hashed_features(parse_raw_df(raw_test_df))\n\nhash_train_df.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+--------------------+\n|label|            features|\n+-----+--------------------+\n|  0.0|(32768,[1613,1659...|\n|  0.0|(32768,[274,590,1...|\n|  0.0|(32768,[1408,1613...|\n|  0.0|(32768,[1613,2034...|\n|  0.0|(32768,[1408,1572...|\n|  0.0|(32768,[1408,1613...|\n|  0.0|(32768,[1408,1613...|\n|  0.0|(32768,[1613,1659...|\n|  0.0|(32768,[1408,1613...|\n|  0.0|(32768,[1613,2034...|\n|  0.0|(32768,[274,1613,...|\n|  0.0|(32768,[400,1443,...|\n|  0.0|(32768,[1027,1613...|\n|  0.0|(32768,[1613,2034...|\n|  0.0|(32768,[340,1408,...|\n|  0.0|(32768,[1408,2034...|\n|  0.0|(32768,[1408,1613...|\n|  0.0|(32768,[1613,2034...|\n|  0.0|(32768,[1613,1659...|\n|  0.0|(32768,[300,1613,...|\n+-----+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;parsed_test_df&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-353-f1278d82d66a&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     23</span> hash_train_df <span class=\"ansiyellow\">=</span> add_hashed_features<span class=\"ansiyellow\">(</span>parsed_train_df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     24</span> hash_validation_df <span class=\"ansiyellow\">=</span> add_hashed_features<span class=\"ansiyellow\">(</span>parsed_validation_df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 25</span><span class=\"ansiyellow\"> </span>hash_test_df <span class=\"ansiyellow\">=</span> add_hashed_features<span class=\"ansiyellow\">(</span>parsed_test_df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     26</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     27</span> hash_train_df<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;parsed_test_df&apos; is not defined\n</div>","workflows":[],"startTime":1.469747412689E12,"submitTime":1.469747412261E12,"finishTime":1.469747412962E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3f195cc6-cc1f-481f-a4c6-f3d300a9f5be"},{"version":"CommandV1","origId":1641625786991757,"guid":"4b683599-f95d-4747-9609-4824c03d4734","subtype":"command","commandType":"auto","position":91.0,"command":"# TEST Creating hashed features (5b)\nhash_train_df_feature_sum = sum(hash_train_df\n                                  .rdd\n                                  .map(lambda r: sum(r[1].indices))\n                                  .take(10))\nhash_validation_df_feature_sum = sum(hash_validation_df\n                                       .rdd\n                                       .map(lambda r: sum(r[1].indices))\n                                       .take(10))\nhash_test_df_feature_sum = sum(hash_test_df\n                                 .rdd\n                                 .map(lambda r: sum(r[1].indices))\n                                 .take(10))\n\nexpected_train_sum = 6499660\nTest.assertEquals(hash_train_df_feature_sum, expected_train_sum,\n                  'incorrect number of features in hash_train_df. Got {0}, expected {1}'.format(hash_train_df_feature_sum, expected_train_sum))\n\nexpected_validation_sum = 6725232\nTest.assertEquals(hash_validation_df_feature_sum, expected_validation_sum,\n                  'incorrect number of features in hash_validation_df. Got {0}, expected {1}'.format(hash_validation_df_feature_sum, expected_validation_sum))\n\nexpected_test_sum = 6885806\nTest.assertEquals(hash_test_df_feature_sum, expected_test_sum, 'incorrect number of features in hash_test_df. Got {0}, expected {1}'.format(hash_test_df_feature_sum, expected_test_sum))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747415932E12,"submitTime":1.469747415487E12,"finishTime":1.469747416909E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"99958833-45f1-4824-876b-7c35b528a6e0"},{"version":"CommandV1","origId":1641625786991758,"guid":"6e3de220-87f3-4b5b-a56b-cc1f7d97b04a","subtype":"command","commandType":"auto","position":92.0,"command":"%md\n### (5c) Sparsity\n\nSince we have 33K hashed features versus 233K OHE features, we should expect OHE features to be sparser. Verify this hypothesis by computing the average sparsity of the OHE and the hashed training datasets.\n\nNote that if you have a `SparseVector` named `sparse`, calling `len(sparse)` returns the total number of features, not the number features with entries.  `SparseVector` objects have the attributes `indices` and `values` that contain information about which features are nonzero.  Continuing with our example, these can be accessed using `sparse.indices` and `sparse.values`, respectively.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296862E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0a3a232f-7f54-483d-abdc-50b583c57283"},{"version":"CommandV1","origId":1641625786991759,"guid":"13086eab-09ae-4665-8c77-bb29e47dbca3","subtype":"command","commandType":"auto","position":93.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef vector_feature_sparsity(sparse_vector):\n    \"\"\"Calculates the sparsity of a SparseVector.\n\n    Args:\n        sparse_vector (SparseVector): The vector containing the features.\n\n    Returns:\n        float: The ratio of features found in the vector to the total number of features.\n    \"\"\"\n    return len(sparse_vector.values) / float(len(sparse_vector))\n    \nfeature_sparsity_udf = udf(vector_feature_sparsity, DoubleType())\n\na_sparse_vector = Vectors.sparse(5, {0: 1.0, 3: 1.0})\na_sparse_vector_sparsity = vector_feature_sparsity(a_sparse_vector)\nprint 'This vector should have sparsity 2/5 or .4.'\nprint 'Sparsity = {0:.2f}.'.format(a_sparse_vector_sparsity)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">This vector should have sparsity 2/5 or .4.\nSparsity = 0.40.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">ValueError</span>: Unknown format code &apos;f&apos; for object of type &apos;str&apos;","error":"<div class=\"ansiout\">This vector should have sparsity 2/5 or .4.\n<span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ValueError</span>                                Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-357-87231803b9b7&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     16</span> a_sparse_vector_sparsity <span class=\"ansiyellow\">=</span> vector_feature_sparsity<span class=\"ansiyellow\">(</span>a_sparse_vector<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     17</span> <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;This vector should have sparsity 2/5 or .4.&apos;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 18</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;Sparsity = {0:.2f}.&apos;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>a_sparse_vector_sparsity<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">ValueError</span>: Unknown format code &apos;f&apos; for object of type &apos;str&apos;\n</div>","workflows":[],"startTime":1.46974755143E12,"submitTime":1.469747550998E12,"finishTime":1.469747551502E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"310e67bb-ae3e-4283-9d62-e8064b897b7b"},{"version":"CommandV1","origId":1641625786991760,"guid":"f627f0c3-5797-4659-92a1-90a456d526fb","subtype":"command","commandType":"auto","position":94.0,"command":"# TEST Sparsity (5c)\nTest.assertEquals(a_sparse_vector_sparsity, .4,\n                'incorrect value for a_sparse_vector_sparsity')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469747560195E12,"submitTime":1.469747559749E12,"finishTime":1.469747560265E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5ab2c85c-f9f7-495e-ae50-29ad1ad9b639"},{"version":"CommandV1","origId":1641625786991761,"guid":"02552727-9736-4414-bf17-76a33f160b44","subtype":"command","commandType":"auto","position":95.0,"command":"%md\n### (5d) Sparsity continued\n\nNow that we have a function to calculate vector sparsity, we'll wrap it in a UDF and apply it to an entire DataFrame to obtain the average sparsity for features in that DataFrame.  We'll use the function to find the average sparsity of the one-hot-encoded training DataFrame and of the hashed training DataFrame.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747296896E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5d799ea3-6f03-4092-9599-711870501cbe"},{"version":"CommandV1","origId":1641625786991762,"guid":"33a48ccf-5da9-4441-aa75-e63953f0f88d","subtype":"command","commandType":"auto","position":96.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nfeature_sparsity_udf = udf(vector_feature_sparsity, DoubleType())\n\ndef get_sparsity(df):\n    \"\"\"Calculates the average sparsity for the features in a DataFrame.\n\n    Args:\n        df (DataFrame with 'features' column): A DataFrame with sparse features.\n\n    Returns:\n        float: The average feature sparsity.\n    \"\"\"\n    return (df.select(feature_sparsity_udf('features').alias('features')).selectExpr(\"avg(features)\").first()[0])\n\naverage_sparsity_ohe = get_sparsity(ohe_train_df)\naverage_sparsity_hash = get_sparsity(hash_train_df)\n\nprint 'Average OHE Sparsity: {0:.7e}'.format(average_sparsity_ohe)\nprint 'Average Hash Sparsity: {0:.7e}'.format(average_sparsity_hash)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Average OHE Sparsity: 1.6670870e-04\nAverage Hash Sparsity: 1.1896630e-03\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469748131025E12,"submitTime":1.469748130579E12,"finishTime":1.469748155783E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"23e479ce-66af-4d83-866d-8de5253d0321"},{"version":"CommandV1","origId":1641625786991763,"guid":"233ba4d3-a1f3-4d2c-8f6e-b98721643b28","subtype":"command","commandType":"auto","position":97.0,"command":"# TEST Sparsity (5d)\nexpected_ohe = 1.6670941e-04\nTest.assertTrue(np.allclose(average_sparsity_ohe, expected_ohe),\n                'incorrect value for average_sparsity_ohe. Got {0}, expected {1}'.format(average_sparsity_ohe, expected_ohe))\nexpected_hash = 1.1896565e-03\nTest.assertTrue(np.allclose(average_sparsity_hash, expected_hash),\n                'incorrect value for average_sparsity_hash. Got {0}, expected {1}'.format(average_sparsity_hash, expected_hash))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.46974816161E12,"submitTime":1.469748161148E12,"finishTime":1.469748161682E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4dbe4f32-8927-4ae9-8849-0ae819951641"},{"version":"CommandV1","origId":1641625786991764,"guid":"4779c4dc-4f4a-432c-b212-5c717cae3edb","subtype":"command","commandType":"auto","position":98.0,"command":"%md\n### (5e) Logistic model with hashed features\n\nNow let's train a logistic regression model using the hashed training features. Use the hyperparameters provided, fit the model, and then evaluate the log loss on the training set.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.46974729713E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fecb4946-a444-4791-b3e3-143037a5b89b"},{"version":"CommandV1","origId":1641625786991765,"guid":"d4361678-8248-4f28-99ac-21b1810e7b29","subtype":"command","commandType":"auto","position":99.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nstandardization = False\nelastic_net_param = 0.7\nreg_param = .001\nmax_iter = 20\n\nlr_hash = LogisticRegression(maxIter=max_iter, regParam=reg_param, elasticNetParam=elastic_net_param,standardization=standardization)\nlr_model_hashed = lr_hash.fit(hash_train_df)\n\nprint 'intercept: {0}'.format(lr_model_hashed.intercept)\nprint len(lr_model_hashed.coefficients)\n\nlog_loss_train_model_hashed = evaluate_results(hash_train_df, lr_model_hashed, None)\nprint ('OHE Features Train Logloss:\\n\\tBaseline = {0:.3f}\\n\\thashed = {1:.3f}'\n       .format(log_loss_tr_base, log_loss_train_model_hashed))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">intercept: -1.24017184805\n32768\nOHE Features Train Logloss:\n\tBaseline = 0.535\n\thashed = 0.465\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-363-53dc04784a72&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">13</span>\n<span class=\"ansiyellow\">    log_loss_train_model_hashed = &lt;FILL IN&gt;</span>\n<span class=\"ansigrey\">                                  ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","workflows":[],"startTime":1.469749126921E12,"submitTime":1.469749126401E12,"finishTime":1.46974916864E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b9ec4e06-d2b8-4fc8-86b8-0edaf0fa2e15"},{"version":"CommandV1","origId":1641625786991766,"guid":"586715a2-901a-4230-b09d-f7f7d6caa12f","subtype":"command","commandType":"auto","position":100.0,"command":"# TEST Logistic model with hashed features (5e)\nexpected =  0.46545524487\nTest.assertTrue(np.allclose(log_loss_train_model_hashed, expected),\n                'incorrect value for log_loss_train_model_hashed. Got {0}, expected {1}'.format(log_loss_train_model_hashed, expected))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469749173231E12,"submitTime":1.469749172749E12,"finishTime":1.469749173304E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"da7be286-a6e2-4d15-ad72-06dc37a1b2ef"},{"version":"CommandV1","origId":1641625786991767,"guid":"df4d4d5f-bcf3-4648-b380-32dfabaffae7","subtype":"command","commandType":"auto","position":101.0,"command":"%md\n### (5f) Evaluate on the test set\n\nFinally, evaluate the model from Part (5e) on the test set.  Compare the resulting log loss with the baseline log loss on the test set, which can be computed in the same way that the validation log loss was computed in Part (4f).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747297185E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"646e3555-525b-4b5b-a7ce-a62ab72893ee"},{"version":"CommandV1","origId":1641625786991768,"guid":"1a5d94b8-0158-4bfb-bf82-b8f63a628118","subtype":"command","commandType":"auto","position":102.0,"command":"# TODO: Replace <FILL IN> with appropriate code\n# Log loss for the best model from (5e)\nlog_loss_test = evaluate_results(hash_test_df,lr_model_hashed,None)\n\n# Log loss for the baseline model\nclass_one_frac_test = hash_test_df.selectExpr(\"avg(label)\").first()[0]\nprint 'Class one fraction for test data: {0}'.format(class_one_frac_test)\nlog_loss_test_baseline = evaluate_results(hash_test_df, None, class_one_frac_test)\n\nprint ('Hashed Features Test Log Loss:\\n\\tBaseline = {0:.3f}\\n\\tLogReg = {1:.3f}'\n       .format(log_loss_test_baseline, log_loss_test))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Class one fraction for test data: 0.222747861097\nHashed Features Test Log Loss:\n\tBaseline = 0.530\n\tLogReg = 0.459\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.lang.RuntimeException: [1.4] failure: identifier expected","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-367-e9a2c2286a6a&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> <span class=\"ansired\"># Log loss for the baseline model</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 6</span><span class=\"ansiyellow\"> </span>class_one_frac_test <span class=\"ansiyellow\">=</span> hash_test_df<span class=\"ansiyellow\">.</span>selectExpr<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;avg&apos;label&apos;&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>first<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;Class one fraction for test data: {0}&apos;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>class_one_frac_test<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span> log_loss_test_baseline <span class=\"ansiyellow\">=</span> evaluate_results<span class=\"ansiyellow\">(</span>hash_test_df<span class=\"ansiyellow\">,</span> None<span class=\"ansiyellow\">,</span> class_one_frac_test<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">selectExpr</span><span class=\"ansiblue\">(self, *expr)</span>\n<span class=\"ansigreen\">    874</span>         <span class=\"ansigreen\">if</span> len<span class=\"ansiyellow\">(</span>expr<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">==</span> <span class=\"ansicyan\">1</span> <span class=\"ansigreen\">and</span> isinstance<span class=\"ansiyellow\">(</span>expr<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> list<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    875</span>             expr <span class=\"ansiyellow\">=</span> expr<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 876</span><span class=\"ansiyellow\">         </span>jdf <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>selectExpr<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jseq<span class=\"ansiyellow\">(</span>expr<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    877</span>         <span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>jdf<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    878</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     43</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     44</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 45</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     46</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     47</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    306</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    307</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 308</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    309</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    310</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o5177.selectExpr.\n: java.lang.RuntimeException: [1.4] failure: identifier expected\n\navg&apos;label&apos;\n   ^\n\tat scala.sys.package$.error(package.scala:27)\n\tat org.apache.spark.sql.catalyst.SqlParser$.parseExpression(SqlParser.scala:49)\n\tat org.apache.spark.sql.DataFrame$$anonfun$selectExpr$1.apply(DataFrame.scala:741)\n\tat org.apache.spark.sql.DataFrame$$anonfun$selectExpr$1.apply(DataFrame.scala:740)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:727)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1157)\n\tat scala.collection.IterableLike$class.foreach(IterableLike.scala:72)\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:54)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat org.apache.spark.sql.DataFrame.selectExpr(DataFrame.scala:740)\n\tat sun.reflect.GeneratedMethodAccessor156.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:381)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:209)\n\tat java.lang.Thread.run(Thread.java:745)\n\n</div>","workflows":[],"startTime":1.469749281344E12,"submitTime":1.469749280873E12,"finishTime":1.469749289587E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"96159a34-6c4d-4aa3-8321-307348c1a99f"},{"version":"CommandV1","origId":1641625786991769,"guid":"d773d791-8818-494d-bfd4-1779a3f96123","subtype":"command","commandType":"auto","position":103.0,"command":"# TEST Evaluate on the test set (5f)\nexpected_test_baseline = 0.530363901139\nTest.assertTrue(np.allclose(log_loss_test_baseline, expected_test_baseline),\n                'incorrect value for log_loss_test_baseline. Got {0}, expected {1}'.format(log_loss_test_baseline, expected_test_baseline))\nexpected_test = 0.458838771351\nTest.assertTrue(np.allclose(log_loss_test, expected_test),\n                'incorrect value for log_loss_test. Got {0}, expected {1}'.format(log_loss_test, expected_test))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469749292111E12,"submitTime":1.469749291626E12,"finishTime":1.469749292151E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fc2d7817-598e-4e51-a576-04dc7c09da16"},{"version":"CommandV1","origId":1641625786991770,"guid":"6de2a327-c55d-42d8-aee4-d96400506413","subtype":"command","commandType":"auto","position":104.0,"command":"%md\n## Part 6: Cleanup\n\nTo avoid exceeding disk storage quotas on Databricks Community Edition, run the following cell to remove the Criteo data file you downloaded earlier.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747297239E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"acda10fb-eb8f-4b42-b205-95f48363c45f"},{"version":"CommandV1","origId":1641625786991771,"guid":"51b494c8-495e-4f2c-8f1d-87ecc0a2ac58","subtype":"command","commandType":"auto","position":105.0,"command":"downloaded_data_file = None\nraw_df = None\ncleanup_old_downloads()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.469749306688E12,"submitTime":1.469749306202E12,"finishTime":1.46974930731E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9aca9f8d-27af-4a01-b669-b197b30b3fd4"},{"version":"CommandV1","origId":1641625786991772,"guid":"9d8ce2d0-4550-457e-8d43-259559f041d1","subtype":"command","commandType":"auto","position":106.0,"command":"%md\n## Appendix A: Submitting Your Exercises to the Autograder\n\nThis section guides you through Step 2 of the grading process (\"Submit to Autograder\").\n\nOnce you confirm that your lab notebook is passing all tests, you can submit it first to the course autograder and then second to the edX website to receive a grade.\n\n** Note that you can only submit to the course autograder once every 1 minute. **","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747297273E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"11933637-8628-4307-a3fc-ccb0371d5116"},{"version":"CommandV1","origId":1641625786991773,"guid":"5312c906-c39b-4aa7-aaa0-d6406480d5bb","subtype":"command","commandType":"auto","position":107.0,"command":"%md\n### Step 2(a): Restart your cluster by clicking on the dropdown next to your cluster name and selecting \"Restart Cluster\".\n\nYou can do this step in either notebook, since there is one cluster for your notebooks.\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/submit_restart.png\" alt=\"Drawing\" />","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747297296E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"76b69867-11ae-4b70-b51a-9541075d500e"},{"version":"CommandV1","origId":1641625786991774,"guid":"1c8c6af4-700d-4026-9175-ea3aba591cf3","subtype":"command","commandType":"auto","position":108.0,"command":"%md\n### Step 2(b): _IN THIS NOTEBOOK_, click on \"Run All\" to run all of the cells.\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/submit_runall.png\" alt=\"Drawing\" style=\"height: 80px\"/>\n\nThis step will take some time.\n\nWait for your cluster to finish running the cells in your lab notebook before proceeding.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747297323E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9b14799f-8337-4d12-a4bc-7cc859dc5c53"},{"version":"CommandV1","origId":1641625786991775,"guid":"53d7d9b0-68a3-4eef-87a9-fa6b61a97e56","subtype":"command","commandType":"auto","position":109.0,"command":"%md\n### Step 2(c): Publish this notebook\n\nPublish _this_ notebook by clicking on the \"Publish\" button at the top.\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/Lab0_Publish0.png\" alt=\"Drawing\" style=\"height: 150px\"/>\n\nWhen you click on the button, you will see the following popup.\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/Lab0_Publish1.png\" alt=\"Drawing\" />\n\nWhen you click on \"Publish\", you will see a popup with your notebook's public link. **Copy the link and set the `notebook_URL` variable in the AUTOGRADER notebook (not this notebook).**\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/Lab0_Publish2.png\" alt=\"Drawing\" />","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747297342E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"08eeeb51-3dd5-4416-8b23-ee69ac05b8f2"},{"version":"CommandV1","origId":1641625786991776,"guid":"e9dc9c77-c018-411a-96bd-f9bb1ce51cc7","subtype":"command","commandType":"auto","position":110.0,"command":"%md\n### Step 2(d): Set the notebook URL and Lab ID in the Autograder notebook, and run it\n\nGo to the Autograder notebook and paste the link you just copied into it, so that it is assigned to the `notebook_url` variable.\n\n```\nnotebook_url = \"...\" # put your URL here\n```\n\nThen, find the line that looks like this:\n\n```\nlab = <FILL IN>\n```\nand change `<FILL IN>` to \"CS120x-lab3\":\n\n```\nlab = \"CS120x-lab3\"\n```\n\nThen, run the Autograder notebook to submit your lab.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.469747297361E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"18da84e8-3d05-4b8b-ba80-374b2c5a5752"},{"version":"CommandV1","origId":1641625786991777,"guid":"9a63fc6c-1191-471d-be2a-6ccdf254fa17","subtype":"command","commandType":"auto","position":111.0,"command":"%md\n### <img src=\"http://spark-mooc.github.io/web-assets/images/oops.png\" style=\"height: 200px\"/> If things go wrong\n\nIt's possible that your notebook looks fine to you, but fails in the autograder. (This can happen when you run cells out of order, as you're working on your notebook.) If that happens, just try again, starting at the top of Appendix A.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.46974729738E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"57e759f3-3784-402c-99f5-b784b43ec1bf"}],"dashboards":[],"guid":"53e61cbc-919a-4df6-a877-72a61eee788f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
